<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>4 Arquitectura MVC - DAW DOCS</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>4 Arquitectura MVC | DAW DOCS</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="4 Arquitectura MVC" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)" /> <meta property="og:description" content="Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)" /> <link rel="canonical" href="/mvc/" /> <meta property="og:url" content="/mvc/" /> <meta property="og:site_name" content="DAW DOCS" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="4 Arquitectura MVC" /> <script type="application/ld+json"> {"@type":"WebPage","url":"/mvc/","headline":"4 Arquitectura MVC","description":"Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> DAW DOCS </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/" class="nav-list-link">Desarrollo Web en Entorno Servidor</a><ul class="nav-list "><li class="nav-list-item "><a href="/cms/" class="nav-list-link">1 Sistemas gestores de contenido (CMS)</a></li><li class="nav-list-item "><a href="/php/" class="nav-list-link">2 Introducción a PHP</a></li><li class="nav-list-item "><a href="/cookies-sesiones-seguridad/" class="nav-list-link">3 Cookies, sesiones y seguridad</a></li><li class="nav-list-item active"><a href="/mvc/" class="nav-list-link active">4 Arquitectura MVC</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/laravel/" class="nav-list-link">5 Laravel</a><ul class="nav-list"><li class="nav-list-item "> <a href="/laravel/1" class="nav-list-link">5.1 Frameworks PHP MVC</a> </li><li class="nav-list-item "> <a href="/laravel/2" class="nav-list-link">5.2 Características de Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/3" class="nav-list-link">5.3 Instalación de Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/4" class="nav-list-link">5.4 Arquitectura, convenciones y configuración de Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/5" class="nav-list-link">5.5 Artisan</a> </li><li class="nav-list-item "> <a href="/laravel/6" class="nav-list-link">5.6 Primeros pasos con Laravel. Hola mundo</a> </li><li class="nav-list-item "> <a href="/laravel/7" class="nav-list-link">5.7 Enrutamiento</a> </li><li class="nav-list-item "> <a href="/laravel/8" class="nav-list-link">5.8 Vistas y plantillas. Blade</a> </li><li class="nav-list-item "> <a href="/laravel/9" class="nav-list-link">5.9 Controladores</a> </li><li class="nav-list-item "> <a href="/laravel/10" class="nav-list-link">5.10 Migraciones</a> </li><li class="nav-list-item "> <a href="/laravel/11" class="nav-list-link">5.11 Usando la BD con Eloquent</a> </li><li class="nav-list-item "> <a href="/laravel/12" class="nav-list-link">5.12 Usando la BD con QueryBuilder</a> </li><li class="nav-list-item "> <a href="/laravel/13" class="nav-list-link">5.13 Sesiones con Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/14" class="nav-list-link">5.14 Helpers de Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/15" class="nav-list-link">5.15 Flujo de trabajo típico con Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/16" class="nav-list-link">5.16 Laravel y Vue.js</a> </li><li class="nav-list-item "> <a href="/laravel/17" class="nav-list-link">5.17 Aspectos avanzados de Laravel</a> </li></ul></li><li class="nav-list-item "><a href="/servicios-web/" class="nav-list-link">6 Servicios web</a></li><li class="nav-list-item "><a href="/ajax/" class="nav-list-link">7 Ajax</a></li><li class="nav-list-item "><a href="/otras-tecnologias/" class="nav-list-link">8 Otras tecnologías</a></li></ul></li><li class="nav-list-item"><a href="/about/" class="nav-list-link">About</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search DAW DOCS" aria-label="Search DAW DOCS" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/">Desarrollo Web en Entorno Servidor</a></li> <li class="breadcrumb-nav-list-item"><span>4 Arquitectura MVC</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="4-arquitectura-mvc"> <a href="#4-arquitectura-mvc" class="anchor-heading" aria-labelledby="4-arquitectura-mvc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4. Arquitectura MVC </h1> <h2 id="41-arquitecturas-físicas-multinivel-multitier"> <a href="#41-arquitecturas-físicas-multinivel-multitier" class="anchor-heading" aria-labelledby="41-arquitecturas-físicas-multinivel-multitier"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.1 Arquitecturas FÍSICAS multinivel (multitier) </h2> <p>Arquitectura en 2 niveles:</p> <p>XXX esquema</p> <p>Arquitectura en 3 niveles:</p> <p>XXX esquema</p> <h2 id="42-arquitecturas-lógicas-multicapa-multilayer"> <a href="#42-arquitecturas-lógicas-multicapa-multilayer" class="anchor-heading" aria-labelledby="42-arquitecturas-lógicas-multicapa-multilayer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.2 Arquitecturas LÓGICAS multicapa (multilayer) </h2> <p>Ventajas: Desarrollos paralelos en cada capa Aplicaciones robustas (encapsulamiento) Matenimiento más sencillo Más flexibilidad para añadir módulos Más escalabilidad para aumentar rendimiento</p> <h3 id="421-esquema-modelo-vista-controlador-mvc"> <a href="#421-esquema-modelo-vista-controlador-mvc" class="anchor-heading" aria-labelledby="421-esquema-modelo-vista-controlador-mvc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.2.1. Esquema Modelo-Vista-Controlador (MVC) </h3> <p>XXX esquema</p> <p>Arquitectura en 3 capas Es una generalización del patrón MVC.</p> <p>XXX esquema</p> <p>Hay que decidir qué componentes hay, sus funciones, y en qué capa y qué nivel físico encaja cada uno.</p> <h3 id="422-otras-arquitecturas-multicapa"> <a href="#422-otras-arquitecturas-multicapa" class="anchor-heading" aria-labelledby="422-otras-arquitecturas-multicapa"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.2.2. Otras arquitecturas multicapa </h3> <p>Modelo de capas mejorado con una capa de entidades</p> <p>XXX esquema</p> <h3 id="423-características-de-las-arquitecturas-multicapa"> <a href="#423-características-de-las-arquitecturas-multicapa" class="anchor-heading" aria-labelledby="423-características-de-las-arquitecturas-multicapa"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.2.3. Características de las arquitecturas multicapa </h3> <p>Funcionalidades transversales presentes en todas las capas: Seguridad Escalabilidad Rendimiento Comunicaciones Control de calidad</p> <h2 id="43-arquitecturas-orientadas-a-los-servicios-soa"> <a href="#43-arquitecturas-orientadas-a-los-servicios-soa" class="anchor-heading" aria-labelledby="43-arquitecturas-orientadas-a-los-servicios-soa"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.3. Arquitecturas orientadas a los servicios (SOA) </h2> <p>Permiten comunicar sistemas diferentes mediante protocolos bien definidos en XML.</p> <p>XXX esquema</p> <p>Los estudiaremos en un tema posterior.</p> <h2 id="44-patrones-de-software"> <a href="#44-patrones-de-software" class="anchor-heading" aria-labelledby="44-patrones-de-software"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.4. Patrones de software </h2> <p>Los patrones de software: Soluciones comprobadas a problemas comunes en el desarrollo de software. Características de un patrón: Debe haber sido comprobado en otros sistemas. Debe ser fácilmente reutilizable. Debe ser aplicable a diferentes circunstancias. Debe estar bien documentado.</p> <h3 id="441-documentación-típica-de-un-patrón-de-software"> <a href="#441-documentación-típica-de-un-patrón-de-software" class="anchor-heading" aria-labelledby="441-documentación-típica-de-un-patrón-de-software"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.4.1. Documentación típica de un patrón de software: </h3> <p>Nombre. Problema que resuelve. Contexto en el que es aplicable. Fuerzas, objetivos y restricciones. Solución que propone. Ejemplos. Contexto resultante. Exposición razonada. Otros patrones relacionados.</p> <h3 id="442-tipos-de-patrones"> <a href="#442-tipos-de-patrones" class="anchor-heading" aria-labelledby="442-tipos-de-patrones"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.4.2. Tipos de patrones: </h3> <p>De arquitectura (p. ej: MVC) De diseño De creación de objetos De estructura de clases De comportamiento De dialectos De interacción o interfaz de usuario De análisis De dominio</p> <h3 id="443-ejemplo-de-patrón-el-patrón-singleton"> <a href="#443-ejemplo-de-patrón-el-patrón-singleton" class="anchor-heading" aria-labelledby="443-ejemplo-de-patrón-el-patrón-singleton"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.4.3. Ejemplo de patrón: el patrón Singleton </h3> <p>Ejemplo de patrón: el patrón Singleton Algunos recursos en una aplicación son de tal naturaleza que sólo puede existir una instancia de ese tipo de recurso. Por ejemplo, la conexión a la base de datos a través de un manejador de base de datos. A veces interesa compartir un manejador de base de datos para que el resto de recursos no tengan que conectarse y desconectarse continuamente de la BD, y sólo debería existir una instancia de ese manejador. El patrón Singleton cubre esta necesidad. Un objeto es “singleton” si la aplicación puede generar una y sólo una instancia del mismo.</p> <p>&lt;?php require_once(“DB.php”);</p> <p>class DatabaseConnection { public static function get() { static $db = null; if ( $db == null ) $db = new DatabaseConnection(); return $db; }</p> <p>private $_handle = null;</p> <p>private function __construct() { $dsn = ‘mysql://root:password@localhost/photos’; $this-&gt;_handle =&amp; DB::Connect( $dsn, array() ); }</p> <p>public function handle() { return $this-&gt;_handle; } }</p> <p>print( “Handle = “.DatabaseConnection::get()-&gt;handle().”\n” ); print( “Handle = “.DatabaseConnection::get()-&gt;handle().”\n” ); ?&gt;</p> <h2 id="45-el-patrón-mvc-en-la-práctica"> <a href="#45-el-patrón-mvc-en-la-práctica" class="anchor-heading" aria-labelledby="45-el-patrón-mvc-en-la-práctica"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.5. El patrón MVC en la práctica </h2> <p>Mostrar lista de artículos de un blog</p> <h3 id="451-código-monolítico"> <a href="#451-código-monolítico" class="anchor-heading" aria-labelledby="451-código-monolítico"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.5.1. Código monolítico </h3> <p>&lt;? $db = new mysqli(‘localhost’, ‘usuario’, ‘clave’, ‘dbname’); $resultado=$db-&gt;query(‘SELECT fecha, titulo FROM articulo’); ?&gt;</p> <h1> Listado de Artículos </h1> <div class="table-wrapper"><table> <tr> <th>Fecha</th> <th>Titulo</th> </tr> <?php while ($fila = $resultado->fetch_array()) { echo "<tr>"; echo "<td> ".$fila['fecha']." </td>"; echo "<td> ".$fila['titulo']." </td>"; echo "</tr>"; } echo "</table></div>"; $db->close(); ?> ### 4.5.2. Primera mejora: controlador + vista Dividir el código en: Un controlador. Una vista. <? // Este es el controlador (esta aplicación solo realiza una acción) $db = new mysqli('localhost', 'usuario', 'clave', 'dbname'); $resultado=$db->query('SELECT fecha, titulo FROM articulo'); $articulos = array(); while ($fila = $resultado->fetch_array()) { $articulos[] = $fila; } $db->close(); ?> include('vista.php'); ?&gt; <!-- Esta es la vista --> <h1> Listado de Articulos </h1> <div class="table-wrapper"><table> <tr> <th>Fecha</th> <th>Titulo</th> </tr> <?php foreach($articulos as $articulo): ?> <tr> <td><?php echo $articulo['fecha']?></td> <td><?php echo $articulo['titulo']?></td> </tr> <?php endforeach;?> </table></div> ### 4.5.3. Segunda mejora: modelo, vista y controlador Dividir el código en: Un controlador. Una vista. Un modelo. // Este es el controlador (solo realiza una acción) include('articulos.php'); // En este archivo estará el modelo $articulos = Articulos::getAllArticulos(); require('vista.php'); // En este archivo estará la vista <?php class Articulos { public function getArticulos() { $db = new mysqli('localhost', 'usuario', 'clave', 'dbname'); $resultado=$db->query('SELECT fecha, titulo FROM articulo'); $articulos = array(); while ($fila = $resultado->fetch_array()) { $articulos[] = $fila; } $db->close(); return $articulos; } } ?> <h1> Listado de Articulos </h1> <div class="table-wrapper"><table> <tr> <th>Fecha</th> <th>Titulo</th> </tr> <?php foreach($articulos as $articulo): ?> <tr> <td><?php echo $articulo['fecha']?></td> <td><?php echo $articulo['titulo']?></td> </tr> <?php endforeach;?> </table></div> ### 4.5.4. Tercera mejora: añadiendo capa de abstracción de datos Dividir el código en: Un controlador. Una vista. Un modelo en dos capas: Capa de abstracción de datos. Capa de acceso a datos. class DbAbstract { private $db; function crearConexion($servidor, $usuario, $clave, $dbname) { $db = new mysqli($servidor, $usuario, $clave, $dbname); } function cerrarConexion() { if ($db) $db-&gt;close(); } function consulta($consulta) { $res = $db→query($consulta); $resArray = array(); if ($res) { $resArray = $res-&gt;fetch_all(); } return $resArray; } ...etc… (añadimos cualquier función que acceda directamente a MySQL) } include "DbAbstract.php"; class Articulos { public function getAllArticulos() { $db = new dbAbstract(); $db-&gt;crearConexion('localhost', 'usuario', 'clave','dbName'); $articulos = $db-&gt;cosulta('SELECT fecha, titulo FROM articulo'); $db-&gt;cerrarConexion(); return $articulos; } } ### 4.5.5. Cuarta mejora: transformación en clases y objetos reutilizables Implementar el código siguiendo el paradigma de orientación a objetos. Crear clase Controlador. Crear clase Vista. $controlador = new Controlador(); $controlador-&gt;main(); include ("Vista.php"); include ("Articulos.php"); class Controlador { public function main() { $estado = (isset($_REQUEST['do']) ? $_REQUEST['do'] ; "formLogin"); switch ($estado) { case "formLogin": ... case "checkLogin": ... case "showAllArticles": $articulos = Articulos::getAllArticulos(); Vista::show("showAllArticles"); break; case "...etc…": ... } } } <?php class Vista { public function show($nombreVista) { include("header.php"); include("$nombreVista.php"); include("footer.php"); } } ?> <h1> Listado de Articulos </h1> <div class="table-wrapper"><table> <tr> <th>Fecha</th> <th>Titulo</th> </tr> <?php foreach($articulos as $articulo): ?> <tr> <td><?php echo $articulo['fecha']?></td> <td><?php echo $articulo['titulo']?></td> </tr> <?php endforeach;?> </table></div> &lt;?php } } include "DbAbstract.php"; class Articulos { public function getAllArticulos() { $db = new dbAbstract(); $db-&gt;crearConexion('localhost', 'usuario', 'clave','dbName'); $articulos = $db-&gt;cosulta('SELECT fecha, titulo FROM articulo'); $db-&gt;cerrarConexion(); return $articulos; } } class DbAbstract { private $db; function crearConexion($servidor, $usuario, $clave, $dbname) { $db = new mysqli($servidor, $usuario, $clave, $dbname); } function cerrarConexion() { if ($db) $db-&gt;close(); } function consulta($consulta) { $res = $db→query($consulta); $resArray = array(); if ($res) { $resArray = $res-&gt;fetch_all(); } return $resArray; } ...etc… (añadimos cualquier función que acceda directamente a MySQL) } </table></div> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
