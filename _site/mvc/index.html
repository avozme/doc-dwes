<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>4 Arquitectura MVC - DAW DOCS</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>4 Arquitectura MVC | DAW DOCS</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="4 Arquitectura MVC" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)" /> <meta property="og:description" content="Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)" /> <link rel="canonical" href="/mvc/" /> <meta property="og:url" content="/mvc/" /> <meta property="og:site_name" content="DAW DOCS" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="4 Arquitectura MVC" /> <script type="application/ld+json"> {"@type":"WebPage","url":"/mvc/","headline":"4 Arquitectura MVC","description":"Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> DAW DOCS </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/" class="nav-list-link">Desarrollo Web en Entorno Servidor</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/cms/" class="nav-list-link">1 Sistemas gestores de contenido (CMS)</a><ul class="nav-list"><li class="nav-list-item "> <a href="/cms/algunas-cosas-que-debes-saber" class="nav-list-link">1.1 Algunas cosas que debes saber sobre los CMS</a> </li><li class="nav-list-item "> <a href="/cms/wordpress" class="nav-list-link">1.2 Wordpress</a> </li><li class="nav-list-item "> <a href="/cms/moodle" class="nav-list-link">1.3 Moodle</a> </li><li class="nav-list-item "> <a href="/cms/prestashop" class="nav-list-link">1.4 Prestashop</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/php/" class="nav-list-link">2 Introducción a PHP</a><ul class="nav-list"><li class="nav-list-item "> <a href="/php/programacion-cliente-servidor" class="nav-list-link">2.1 Programación cliente-servidor</a> </li><li class="nav-list-item "> <a href="/php/caja-de-herramientas" class="nav-list-link">2.2 Caja de herramientas</a> </li><li class="nav-list-item "> <a href="/php/sintaxis-de-php" class="nav-list-link">2.3 Sintaxis de PHP</a> </li><li class="nav-list-item "> <a href="/php/interaccion-con-php" class="nav-list-link">2.4 Interacción con la base de datos</a> </li><li class="nav-list-item "> <a href="/php/ejercicios-resueltos" class="nav-list-link">2.5 Ejercicios resueltos</a> </li></ul></li><li class="nav-list-item "><a href="/cookies-sesiones-seguridad/" class="nav-list-link">3 Cookies, sesiones y seguridad</a></li><li class="nav-list-item active"><a href="/mvc/" class="nav-list-link active">4 Arquitectura MVC</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/laravel/" class="nav-list-link">5 Laravel</a><ul class="nav-list"><li class="nav-list-item "> <a href="/laravel/1" class="nav-list-link">5.1 Frameworks PHP MVC</a> </li><li class="nav-list-item "> <a href="/laravel/2" class="nav-list-link">5.2 Características de Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/3" class="nav-list-link">5.3 Instalación de Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/4" class="nav-list-link">5.4 Arquitectura, convenciones y configuración de Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/5" class="nav-list-link">5.5 Artisan</a> </li><li class="nav-list-item "> <a href="/laravel/6" class="nav-list-link">5.6 Primeros pasos con Laravel. Hola mundo</a> </li><li class="nav-list-item "> <a href="/laravel/7" class="nav-list-link">5.7 Enrutamiento</a> </li><li class="nav-list-item "> <a href="/laravel/8" class="nav-list-link">5.8 Vistas y plantillas. Blade</a> </li><li class="nav-list-item "> <a href="/laravel/9" class="nav-list-link">5.9 Controladores</a> </li><li class="nav-list-item "> <a href="/laravel/10" class="nav-list-link">5.10 Migraciones</a> </li><li class="nav-list-item "> <a href="/laravel/11" class="nav-list-link">5.11 Usando la BD con Eloquent</a> </li><li class="nav-list-item "> <a href="/laravel/12" class="nav-list-link">5.12 Usando la BD con QueryBuilder</a> </li><li class="nav-list-item "> <a href="/laravel/13" class="nav-list-link">5.13 Sesiones con Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/14" class="nav-list-link">5.14 Helpers de Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/15" class="nav-list-link">5.15 Flujo de trabajo típico con Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/16" class="nav-list-link">5.16 Laravel y Vue.js</a> </li><li class="nav-list-item "> <a href="/laravel/17" class="nav-list-link">5.17 Aspectos avanzados de Laravel</a> </li></ul></li><li class="nav-list-item "><a href="/servicios-web/" class="nav-list-link">6 Servicios web</a></li><li class="nav-list-item "><a href="/ajax/" class="nav-list-link">7 Ajax</a></li><li class="nav-list-item "><a href="/otras-tecnologias/" class="nav-list-link">8 Otras tecnologías</a></li><li class="nav-list-item "><a href="/scv-git/" class="nav-list-link">Anexo I. Sistemas de control de versiones. Git</a></li></ul></li><li class="nav-list-item"><a href="/about/" class="nav-list-link">About</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search DAW DOCS" aria-label="Search DAW DOCS" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/">Desarrollo Web en Entorno Servidor</a></li> <li class="breadcrumb-nav-list-item"><span>4 Arquitectura MVC</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="4-arquitectura-mvc"> <a href="#4-arquitectura-mvc" class="anchor-heading" aria-labelledby="4-arquitectura-mvc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4. Arquitectura MVC </h1> <p>Cuando hablamos de arquitectura de una aplicación web nos referimos a la estructura básica que la sustenta, como los pilares de un edificio en construcción. Si quitas las paredes, las ventanas, las puertas, los azulejos de la cocina… todavía pueden distinguirse las formas fundamentales, ¿verdad?</p> <p>En este tema, hablaremos mucho de la arquitectura más popular en aplicaciones web (llamada MVC; no te preocupes, pronto se convertirá en tu mejor amiga). Pero, antes, vamos a darle una vuelta al término “arquitectura”, porque en aplicaciones web se usa con dos significados distintos que conviene que tengas claros para no hacerte un lío.</p> <h2 id="41-arquitecturas-físicas-multinivel-multitier"> <a href="#41-arquitecturas-físicas-multinivel-multitier" class="anchor-heading" aria-labelledby="41-arquitecturas-físicas-multinivel-multitier"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.1 Arquitecturas FÍSICAS multinivel (multitier) </h2> <p>Hablamos indistintamente de “arquitectura de una aplicación web” para referirnos a dos cosas distintas: la arquitectura física y la arquitectura lógica. Y ahí empiezan los líos.</p> <p>Vamos a intentar desliarnos antes de apretar el nudo.</p> <p>Una <strong>arquitectura física de varios niveles</strong> (multinivel o multitier, en inglés) consiste en un conjunto de ordenadores conectados a una red que ejecutan de forma conjunta una aplicación.</p> <p>El ejemplo más sencillo es la arquitectura cliente-servidor, la más popular en aplicaciones web sencillas: una máquina cliente y una máquina servidor ejecutan alternativamente fragmentos del código, proporcionando al usuario final la sensación de una aplicación unificada.</p> <p><img src="/assets/images/04-arquitectura-2-niveles.png" alt="Arquitectura en 2 niveles" /></p> <p>Por supuesto, nada impide que tengamos más de dos máquinas colaborando en red par ejecutar una aplicación web. Podemos tener, por ejemplo, un cliente, un servidor web y un servidor de bases de datos (estos dos últimos en dos máquinas físicas diferentes). Esto sería una arquitectura de 3 niveles físicos.</p> <p>La arquitectura de N niveles tendría este aspecto:</p> <p><img src="/assets/images/04-arquitectura-N-niveles.png" alt="Arquitectura en N niveles" /></p> <h2 id="42-arquitecturas-lógicas-multicapa-multilayer"> <a href="#42-arquitecturas-lógicas-multicapa-multilayer" class="anchor-heading" aria-labelledby="42-arquitecturas-lógicas-multicapa-multilayer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.2 Arquitecturas LÓGICAS multicapa (multilayer) </h2> <p>Ahora viene la vuelta de tuerca: la arquitectura de una aplicación también puede referirse a sus capas (layers) lógicas. Es decir, a las capas de software que nosotros, como desarrolladores, crearemos.</p> <p>Dividir una aplicación en capas que colaboran entre sí por medio de interfaces bien definidos no es una idea nueva, ni pertenece exclusivamente al ámbito de la programación web. Pero la mayor parte de las aplicaciones web hacen uso de este mecanismo de abstracción.</p> <p>La idea es dividir nuestra aplicación en capas de niveles de abstracción cada vez mayor. La capa superior (la más abstracta) es la que interacciona con el usuario: ahí se implementará nuestro interfaz de usuario, o lo que en aplicaciones web se llama <em>front-end</em>.</p> <p>La capa inferior (la menos abstracta) es la que está en contacto con el hardware de la máquina. Bueno, con el hardware no: debajo de ella habrá otras capas que ya no pertenecen a nuestra aplicación y que se encargarán de ello: el sistema operativo, el servidor, el gestor de bases de datos, o lo que sea. Pero nuestra capa inferior será la que interactúe con esas otras capas que escapan a nuestros dominios y que están en contacto con la máquina.</p> <p>Esta división en capas de abstracción, que puede parecer al neófito una complicación innecesaria, tiene un montón de ventajas y por eso se usa en cualquier aplicación un poco más complicada que “Hola, mundo”.</p> <h3 id="421-ventajas-de-las-arquitecturas-multicapa"> <a href="#421-ventajas-de-las-arquitecturas-multicapa" class="anchor-heading" aria-labelledby="421-ventajas-de-las-arquitecturas-multicapa"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.2.1. Ventajas de las arquitecturas multicapa </h3> <p>Las arquitecturas multicapa permiten varias cosas que no pueden hacerse con los códigos monolíticos. Entre otras:</p> <ul> <li>Desarrollar en paralelo cada capa (mayor rapidez de desarrollo).</li> <li>Aplicaciones más robustas (gracias al encapsulamiento. ¿Te suena? ¡Programación orientada a objetos!).</li> <li>Matenimiento más sencillo.</li> <li>Más flexibilidad para añadir módulos.</li> <li>Más escalabilidad para aumentar rendimiento.</li> </ul> <h3 id="421-esquema-modelo-vista-controlador-mvc"> <a href="#421-esquema-modelo-vista-controlador-mvc" class="anchor-heading" aria-labelledby="421-esquema-modelo-vista-controlador-mvc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.2.1. Esquema Modelo-Vista-Controlador (MVC) </h3> <p>Y por fin llegamos a la palabreja: Modelo-Vista-Controlador o MVC. ¿Qué narices es esto?</p> <p>Tan solo una arquitectura multicapa estandarizada. Una arquitectura de 3 capas, para ser exactos.</p> <p>Este es el esquema de una arquitectura en 3 capas. Recuerda: cada capa ejecuta una parte de la solución, y entre ellas colaboran para formar la aplicación completa. La capa superior interactúa con el usuario; la capa inferior, con la máquina (donde dice “hardware”, debería decir “cualquier cosa menos abstracta que nuestro programa”). Tienes permiso para imaginar cada capa como una clase con sus métodos y atributos.</p> <p><img src="/assets/images/04-arquitectura-3-capas.png" alt="Arquitectura en 3 capas" /></p> <p>Pues bien, si a esas tres les ponemos nombres exóticos como modelo, vista y controlador, y remeneamos un poco el esquema, ya lo tenemos: la arquitectura MVC.</p> <p><img src="/assets/images/04-arquitectura-mvc.png" alt="Arquitectura MVC" /></p> <p>Es decir, la arquitectura MVC solo es un caso particular de la arquitectura en 3 capas.</p> <p>¿Y ya está? Bueno, no. Ahora tienes que aprender qué signfica <em>en realidad</em> esta palabrería.</p> <p>Para que tengas una idea completa del asunto, ahora tienes que aprender qué parte de la aplicación se ejecuta en cada una de las capas. Pero es más simple de lo que parece. Y lo maravilloso es que el 99,99% de las aplicaciones web encajan como un guante en esta arquitectura. Es decir, apenas tendremos que hacer trabajo de diseño previo, porque, si es una aplicación web, ya sabemos qué clases tendremos que construir: los que nos indique la arquitectura MVC.</p> <p>Antes de entrar en profundidad, un breve apunte: por supuesto, nada impide construir arquitecturas con más de 3 capas. De hecho, nosotros vamos a usar una variante del MVC en el que se añade una capa adicional por debajo del modelo, es decir, una arquitectura con 4 capas. Pero ya llegaremos a eso.</p> <h3 id="422-otras-arquitecturas-multicapa"> <a href="#422-otras-arquitecturas-multicapa" class="anchor-heading" aria-labelledby="422-otras-arquitecturas-multicapa"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.2.2. Otras arquitecturas multicapa </h3> <p>Modelo de capas mejorado con una capa de entidades</p> <p>XXX esquema</p> <h3 id="423-características-de-las-arquitecturas-multicapa"> <a href="#423-características-de-las-arquitecturas-multicapa" class="anchor-heading" aria-labelledby="423-características-de-las-arquitecturas-multicapa"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.2.3. Características de las arquitecturas multicapa </h3> <p>Funcionalidades transversales presentes en todas las capas: Seguridad Escalabilidad Rendimiento Comunicaciones Control de calidad</p> <h2 id="43-arquitecturas-orientadas-a-los-servicios-soa"> <a href="#43-arquitecturas-orientadas-a-los-servicios-soa" class="anchor-heading" aria-labelledby="43-arquitecturas-orientadas-a-los-servicios-soa"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.3. Arquitecturas orientadas a los servicios (SOA) </h2> <p>Permiten comunicar sistemas diferentes mediante protocolos bien definidos en XML.</p> <p>XXX esquema</p> <p>Los estudiaremos en un tema posterior.</p> <h2 id="44-patrones-de-software"> <a href="#44-patrones-de-software" class="anchor-heading" aria-labelledby="44-patrones-de-software"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.4. Patrones de software </h2> <p>Los patrones de software: Soluciones comprobadas a problemas comunes en el desarrollo de software. Características de un patrón: Debe haber sido comprobado en otros sistemas. Debe ser fácilmente reutilizable. Debe ser aplicable a diferentes circunstancias. Debe estar bien documentado.</p> <h3 id="441-documentación-típica-de-un-patrón-de-software"> <a href="#441-documentación-típica-de-un-patrón-de-software" class="anchor-heading" aria-labelledby="441-documentación-típica-de-un-patrón-de-software"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.4.1. Documentación típica de un patrón de software: </h3> <p>Nombre. Problema que resuelve. Contexto en el que es aplicable. Fuerzas, objetivos y restricciones. Solución que propone. Ejemplos. Contexto resultante. Exposición razonada. Otros patrones relacionados.</p> <h3 id="442-tipos-de-patrones"> <a href="#442-tipos-de-patrones" class="anchor-heading" aria-labelledby="442-tipos-de-patrones"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.4.2. Tipos de patrones: </h3> <p>De arquitectura (p. ej: MVC) De diseño De creación de objetos De estructura de clases De comportamiento De dialectos De interacción o interfaz de usuario De análisis De dominio</p> <h3 id="443-ejemplo-de-patrón-el-patrón-singleton"> <a href="#443-ejemplo-de-patrón-el-patrón-singleton" class="anchor-heading" aria-labelledby="443-ejemplo-de-patrón-el-patrón-singleton"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.4.3. Ejemplo de patrón: el patrón Singleton </h3> <p>Ejemplo de patrón: el patrón Singleton Algunos recursos en una aplicación son de tal naturaleza que sólo puede existir una instancia de ese tipo de recurso. Por ejemplo, la conexión a la base de datos a través de un manejador de base de datos. A veces interesa compartir un manejador de base de datos para que el resto de recursos no tengan que conectarse y desconectarse continuamente de la BD, y sólo debería existir una instancia de ese manejador. El patrón Singleton cubre esta necesidad. Un objeto es “singleton” si la aplicación puede generar una y sólo una instancia del mismo.</p> <p>&lt;?php require_once(“DB.php”);</p> <p>class DatabaseConnection { public static function get() { static $db = null; if ( $db == null ) $db = new DatabaseConnection(); return $db; }</p> <p>private $_handle = null;</p> <p>private function __construct() { $dsn = ‘mysql://root:password@localhost/photos’; $this-&gt;_handle =&amp; DB::Connect( $dsn, array() ); }</p> <p>public function handle() { return $this-&gt;_handle; } }</p> <p>print( “Handle = “.DatabaseConnection::get()-&gt;handle().”\n” ); print( “Handle = “.DatabaseConnection::get()-&gt;handle().”\n” ); ?&gt;</p> <h2 id="45-el-patrón-mvc-en-la-práctica"> <a href="#45-el-patrón-mvc-en-la-práctica" class="anchor-heading" aria-labelledby="45-el-patrón-mvc-en-la-práctica"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.5. El patrón MVC en la práctica </h2> <p>Mostrar lista de artículos de un blog</p> <h3 id="451-código-monolítico"> <a href="#451-código-monolítico" class="anchor-heading" aria-labelledby="451-código-monolítico"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.5.1. Código monolítico </h3> <p>&lt;? $db = new mysqli(‘localhost’, ‘usuario’, ‘clave’, ‘dbname’); $resultado=$db-&gt;query(‘SELECT fecha, titulo FROM articulo’); ?&gt;</p> <h1> Listado de Artículos </h1> <div class="table-wrapper"><table> <tr> <th>Fecha</th> <th>Titulo</th> </tr> <?php while ($fila = $resultado->fetch_array()) { echo "<tr>"; echo "<td> ".$fila['fecha']." </td>"; echo "<td> ".$fila['titulo']." </td>"; echo "</tr>"; } echo "</table></div>"; $db->close(); ?> ### 4.5.2. Primera mejora: controlador + vista Dividir el código en: Un controlador. Una vista. <? // Este es el controlador (esta aplicación solo realiza una acción) $db = new mysqli('localhost', 'usuario', 'clave', 'dbname'); $resultado=$db->query('SELECT fecha, titulo FROM articulo'); $articulos = array(); while ($fila = $resultado->fetch_array()) { $articulos[] = $fila; } $db->close(); ?> include('vista.php'); ?&gt; <!-- Esta es la vista --> <h1> Listado de Articulos </h1> <div class="table-wrapper"><table> <tr> <th>Fecha</th> <th>Titulo</th> </tr> <?php foreach($articulos as $articulo): ?> <tr> <td><?php echo $articulo['fecha']?></td> <td><?php echo $articulo['titulo']?></td> </tr> <?php endforeach;?> </table></div> ### 4.5.3. Segunda mejora: modelo, vista y controlador Dividir el código en: Un controlador. Una vista. Un modelo. // Este es el controlador (solo realiza una acción) include('articulos.php'); // En este archivo estará el modelo $articulos = Articulos::getAllArticulos(); require('vista.php'); // En este archivo estará la vista <?php class Articulos { public function getArticulos() { $db = new mysqli('localhost', 'usuario', 'clave', 'dbname'); $resultado=$db->query('SELECT fecha, titulo FROM articulo'); $articulos = array(); while ($fila = $resultado->fetch_array()) { $articulos[] = $fila; } $db->close(); return $articulos; } } ?> <h1> Listado de Articulos </h1> <div class="table-wrapper"><table> <tr> <th>Fecha</th> <th>Titulo</th> </tr> <?php foreach($articulos as $articulo): ?> <tr> <td><?php echo $articulo['fecha']?></td> <td><?php echo $articulo['titulo']?></td> </tr> <?php endforeach;?> </table></div> ### 4.5.4. Tercera mejora: añadiendo capa de abstracción de datos Dividir el código en: Un controlador. Una vista. Un modelo en dos capas: Capa de abstracción de datos. Capa de acceso a datos. class DbAbstract { private $db; function crearConexion($servidor, $usuario, $clave, $dbname) { $db = new mysqli($servidor, $usuario, $clave, $dbname); } function cerrarConexion() { if ($db) $db-&gt;close(); } function consulta($consulta) { $res = $db→query($consulta); $resArray = array(); if ($res) { $resArray = $res-&gt;fetch_all(); } return $resArray; } ...etc… (añadimos cualquier función que acceda directamente a MySQL) } include "DbAbstract.php"; class Articulos { public function getAllArticulos() { $db = new dbAbstract(); $db-&gt;crearConexion('localhost', 'usuario', 'clave','dbName'); $articulos = $db-&gt;cosulta('SELECT fecha, titulo FROM articulo'); $db-&gt;cerrarConexion(); return $articulos; } } ### 4.5.5. Cuarta mejora: transformación en clases y objetos reutilizables Implementar el código siguiendo el paradigma de orientación a objetos. Crear clase Controlador. Crear clase Vista. $controlador = new Controlador(); $controlador-&gt;main(); include ("Vista.php"); include ("Articulos.php"); class Controlador { public function main() { $estado = (isset($_REQUEST['do']) ? $_REQUEST['do'] ; "formLogin"); switch ($estado) { case "formLogin": ... case "checkLogin": ... case "showAllArticles": $articulos = Articulos::getAllArticulos(); Vista::show("showAllArticles"); break; case "...etc…": ... } } } <?php class Vista { public function show($nombreVista) { include("header.php"); include("$nombreVista.php"); include("footer.php"); } } ?> <h1> Listado de Articulos </h1> <div class="table-wrapper"><table> <tr> <th>Fecha</th> <th>Titulo</th> </tr> <?php foreach($articulos as $articulo): ?> <tr> <td><?php echo $articulo['fecha']?></td> <td><?php echo $articulo['titulo']?></td> </tr> <?php endforeach;?> </table></div> &lt;?php } } include "DbAbstract.php"; class Articulos { public function getAllArticulos() { $db = new dbAbstract(); $db-&gt;crearConexion('localhost', 'usuario', 'clave','dbName'); $articulos = $db-&gt;cosulta('SELECT fecha, titulo FROM articulo'); $db-&gt;cerrarConexion(); return $articulos; } } class DbAbstract { private $db; function crearConexion($servidor, $usuario, $clave, $dbname) { $db = new mysqli($servidor, $usuario, $clave, $dbname); } function cerrarConexion() { if ($db) $db-&gt;close(); } function consulta($consulta) { $res = $db→query($consulta); $resArray = array(); if ($res) { $resArray = $res-&gt;fetch_all(); } return $resArray; } ...etc… (añadimos cualquier función que acceda directamente a MySQL) } </table></div> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
