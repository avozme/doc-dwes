<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>5.13 Sesiones con Laravel - DAW DOCS</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>5.13 Sesiones con Laravel | DAW DOCS</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="5.13 Sesiones con Laravel" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)" /> <meta property="og:description" content="Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)" /> <link rel="canonical" href="/laravel/13" /> <meta property="og:url" content="/laravel/13" /> <meta property="og:site_name" content="DAW DOCS" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="5.13 Sesiones con Laravel" /> <script type="application/ld+json"> {"@type":"WebPage","url":"/laravel/13","headline":"5.13 Sesiones con Laravel","description":"Apuntes del módulo de “Desarrollo web en entorno servidor”, de 2º curso del Ciclo Formativo de Grado Superior de “Desarrollo de Aplicaciones Web”, impartido en el IES Celia Viñas de Almería (España)","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> DAW DOCS </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/" class="nav-list-link">Desarrollo Web en Entorno Servidor</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/cms/" class="nav-list-link">1 Sistemas gestores de contenido (CMS)</a><ul class="nav-list"><li class="nav-list-item "> <a href="/cms/algunas-cosas-que-debes-saber" class="nav-list-link">1.1 Algunas cosas que debes saber sobre los CMS</a> </li><li class="nav-list-item "> <a href="/cms/wordpress" class="nav-list-link">1.2 Wordpress</a> </li><li class="nav-list-item "> <a href="/cms/moodle" class="nav-list-link">1.3 Moodle</a> </li><li class="nav-list-item "> <a href="/cms/prestashop" class="nav-list-link">1.4 Prestashop</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/php/" class="nav-list-link">2 Introducción a PHP</a><ul class="nav-list"><li class="nav-list-item "> <a href="/php/programacion-cliente-servidor" class="nav-list-link">2.1 Programación cliente-servidor</a> </li><li class="nav-list-item "> <a href="/php/caja-de-herramientas" class="nav-list-link">2.2 Caja de herramientas</a> </li><li class="nav-list-item "> <a href="/php/sintaxis-de-php" class="nav-list-link">2.3 Sintaxis de PHP</a> </li><li class="nav-list-item "> <a href="/php/interaccion-con-php" class="nav-list-link">2.4 Interacción con la base de datos</a> </li><li class="nav-list-item "> <a href="/php/ejercicios-resueltos" class="nav-list-link">2.5 Ejercicios resueltos</a> </li></ul></li><li class="nav-list-item "><a href="/cookies-sesiones-seguridad/" class="nav-list-link">3 Cookies, sesiones y seguridad</a></li><li class="nav-list-item "><a href="/mvc/" class="nav-list-link">4 Arquitectura MVC</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/laravel/" class="nav-list-link">5 Laravel</a><ul class="nav-list"><li class="nav-list-item "> <a href="/laravel/1" class="nav-list-link">5.1 Frameworks PHP MVC</a> </li><li class="nav-list-item "> <a href="/laravel/2" class="nav-list-link">5.2 Características de Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/3" class="nav-list-link">5.3 Instalación de Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/4" class="nav-list-link">5.4 Arquitectura, convenciones y configuración de Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/5" class="nav-list-link">5.5 Artisan</a> </li><li class="nav-list-item "> <a href="/laravel/6" class="nav-list-link">5.6 Primeros pasos con Laravel. Hola mundo</a> </li><li class="nav-list-item "> <a href="/laravel/7" class="nav-list-link">5.7 Enrutamiento</a> </li><li class="nav-list-item "> <a href="/laravel/8" class="nav-list-link">5.8 Vistas y plantillas. Blade</a> </li><li class="nav-list-item "> <a href="/laravel/9" class="nav-list-link">5.9 Controladores</a> </li><li class="nav-list-item "> <a href="/laravel/10" class="nav-list-link">5.10 Migraciones</a> </li><li class="nav-list-item "> <a href="/laravel/11" class="nav-list-link">5.11 Usando la BD con Eloquent</a> </li><li class="nav-list-item "> <a href="/laravel/12" class="nav-list-link">5.12 Usando la BD con QueryBuilder</a> </li><li class="nav-list-item active"> <a href="/laravel/13" class="nav-list-link active">5.13 Sesiones con Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/14" class="nav-list-link">5.14 Helpers de Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/15" class="nav-list-link">5.15 Flujo de trabajo típico con Laravel</a> </li><li class="nav-list-item "> <a href="/laravel/16" class="nav-list-link">5.16 Laravel y Vue.js</a> </li><li class="nav-list-item "> <a href="/laravel/17" class="nav-list-link">5.17 Aspectos avanzados de Laravel</a> </li></ul></li><li class="nav-list-item "><a href="/servicios-web/" class="nav-list-link">6 Servicios web</a></li><li class="nav-list-item "><a href="/ajax/" class="nav-list-link">7 Ajax</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/otras-tecnologias/" class="nav-list-link">8 Otras tecnologías</a><ul class="nav-list"><li class="nav-list-item "> <a href="/otros/cgi" class="nav-list-link">8.1 CGI</a> </li><li class="nav-list-item "> <a href="/otros/perl" class="nav-list-link">8.2 Perl</a> </li><li class="nav-list-item "> <a href="/otros/python" class="nav-list-link">8.3 Python</a> </li><li class="nav-list-item "> <a href="/otros/.net" class="nav-list-link">8.4 .NET</a> </li><li class="nav-list-item "> <a href="/otros/jsp" class="nav-list-link">8.5 JSP</a> </li><li class="nav-list-item "> <a href="/otros/ruby" class="nav-list-link">8.6 Ruby</a> </li><li class="nav-list-item "> <a href="/otros/nodejs" class="nav-list-link">8.7 NodeJS</a> </li><li class="nav-list-item "> <a href="/otros/mas-tecnologias-aun" class="nav-list-link">8.8 Más tecnologías aún</a> </li></ul></li><li class="nav-list-item "><a href="/scv-git/" class="nav-list-link">Apéndice I. Sistemas de control de versiones. Git</a></li></ul></li><li class="nav-list-item"><a href="/about/" class="nav-list-link">About</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search DAW DOCS" aria-label="Search DAW DOCS" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/">Desarrollo Web en Entorno Servidor</a></li> <li class="breadcrumb-nav-list-item"><a href="/laravel/">5 Laravel</a></li> <li class="breadcrumb-nav-list-item"><span>5.13 Sesiones con Laravel</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h2 id="513-sesiones-con-laravel"> <a href="#513-sesiones-con-laravel" class="anchor-heading" aria-labelledby="513-sesiones-con-laravel"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5.13. Sesiones con Laravel </h2> <p>Como es lógico, Laravel también proporciona su propio sistema de manejo de variables de sesión, y este resulta mucho más seguro y poderoso que el estándar de PHP. En esta sección vamos a ver cómo funciona y qué posibilidades nos ofrece.</p> <h3 id="5131-drivers-de-sesión"> <a href="#5131-drivers-de-sesión" class="anchor-heading" aria-labelledby="5131-drivers-de-sesión"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5.13.1. Drivers de sesión </h3> <p>Las sesiones de configuran en /config/sessions.php, y una de las cosas que debes configurar ahí es el “driver”, es decir, el tipo de manejador que quieres que manipule las sesiones.</p> <p>El driver por defecto es <strong><em>files</em></strong>. Es el más sencillo y funcionará en casi cualquier servidor.</p> <p>En producción, Laravel recomienda usar otros drivers llamados <strong><em>memcached</em></strong> o <strong><em>redis</em></strong> porque son más rápidos. Ambos son daemons del sistema programados para esta tarea. Obviamente, el servidor debe soportarlos para que puedas usarlos.</p> <p>Si necesitas seguridad adicional, sin duda tu driver es <strong><em>database</em></strong>. Esto almacenará dos copias de cada variable de sesión: una en un fichero y otra en una tabla especial de la base de datos. Si un atacante consiguiera manipular una de las dos variables, Laravel cerrará la sesión automáticamente y el atacante se quedará con un palmo de narices. Eso sí, este sistema es el más lento de todos porque requiere un acceso a la base de datos para cada petición al servidor.</p> <h3 id="5132-persistencia-de-las-variables-de-sesión"> <a href="#5132-persistencia-de-las-variables-de-sesión" class="anchor-heading" aria-labelledby="5132-persistencia-de-las-variables-de-sesión"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5.13.2. Persistencia de las variables de sesión </h3> <p>Laravel maneja dos tipos de variable según su persistencia:</p> <ul> <li>Variables flash: solo duran una petición y luego se autodestruyen.</li> <li>Variables de sesión convencionales: existen hasta que las destruimos expresamente.</li> </ul> <h4 id="51321-variables-flash"> <a href="#51321-variables-flash" class="anchor-heading" aria-labelledby="51321-variables-flash"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5.13.2.1. Variables flash </h4> <p>Son variables de sesión que solo duran una petición y luego se autodestruyen. Se usan típicamente para enviar feedback al usuario.</p> <p>Te lo muestro con un ejemplo.</p> <p>En el controlador:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">return</span> <span class="p">(</span><span class="s1">'login/form'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">with</span><span class="p">(</span><span class="s1">'mensaje'</span><span class="p">,</span> <span class="s1">'Usuario no reconocido'</span><span class="p">);</span>
</code></pre></div></div> <p>En la vista:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="o">@</span><span class="k">if</span> <span class="p">(</span><span class="nf">session</span><span class="p">(</span><span class="s1">'mensaje'</span><span class="p">))</span>
        <span class="p">{{</span> <span class="nf">session</span><span class="p">(</span><span class="s1">'mensaje'</span><span class="p">);</span> <span class="p">}}</span>
    <span class="o">@</span><span class="k">endif</span>
</code></pre></div></div> <h4 id="51322-variables-de-sesión-convencionales"> <a href="#51322-variables-de-sesión-convencionales" class="anchor-heading" aria-labelledby="51322-variables-de-sesión-convencionales"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5.13.2.2. Variables de sesión convencionales </h4> <p>Las variables de sesión convencionales se manejan con la clase Session, que tiene un montón de métodos estáticos para crear variables, destruirlas, consultarlas, etc.</p> <p>Los métodos más útiles son:</p> <ul> <li><strong>put()</strong> -&gt; almacena una variable de sesión:</li> </ul> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="nc">Session</span><span class="o">::</span><span class="nf">put</span><span class="p">(</span><span class="s1">'nombre-variable'</span><span class="p">,</span> <span class="s1">'valor'</span><span class="p">);</span>
</code></pre></div></div> <ul> <li><strong>push()</strong> -&gt; elimina una variable de sesión:</li> </ul> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="nc">Session</span><span class="o">::</span><span class="nf">push</span><span class="p">(</span><span class="s1">'nombre-variable'</span><span class="p">);</span>
</code></pre></div></div> <ul> <li><strong>get()</strong> -&gt; devuelve el valor de una variable de sesión:</li> </ul> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="nv">$v</span> <span class="o">=</span> <span class="nc">Session</span><span class="o">::</span><span class="nf">get</span><span class="p">(</span><span class="s1">'nombre-variable'</span><span class="p">);</span>
   <span class="nv">$v</span> <span class="o">=</span> <span class="nc">Session</span><span class="o">::</span><span class="nf">get</span><span class="p">(</span><span class="s1">'nombre-variable'</span><span class="p">,</span> <span class="s1">'valor-por-defecto'</span><span class="p">);</span>
</code></pre></div></div> <ul> <li><strong>all()</strong> devuelve todas las variables de sesión en un array:</li> </ul> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="nv">$a</span> <span class="o">=</span> <span class="nc">Session</span><span class="o">::</span><span class="nf">all</span><span class="p">(</span><span class="s1">'nombre-variable'</span><span class="p">,</span> <span class="s1">'valor'</span><span class="p">);</span>
</code></pre></div></div> <ul> <li><strong>flush()</strong> elimina todas las variables de sesión:</li> </ul> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="nc">Session</span><span class="o">::</span><span class="nb">flush</span><span class="p">();</span>
</code></pre></div></div> <ul> <li><strong>flash()</strong> crea manualmente una variable de sesión de tipo flash:</li> </ul> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="nc">Session</span><span class="o">::</span><span class="nf">flash</span><span class="p">(</span><span class="s1">'nombre-variable'</span><span class="p">,</span> <span class="s1">'valor'</span><span class="p">);</span>
</code></pre></div></div> <h3 id="5133-autenticación"> <a href="#5133-autenticación" class="anchor-heading" aria-labelledby="5133-autenticación"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5.13.3. Autenticación </h3> <h4 id="51331-laravel-breeze"> <a href="#51331-laravel-breeze" class="anchor-heading" aria-labelledby="51331-laravel-breeze"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5.13.3.1. Laravel Breeze </h4> <p>Laravel proporciona un Starter Kit llamado <strong><em>Breeze</em></strong> que viene con todo el código necesario para crear un sistema de autenticación completo y seguro:</p> <ul> <li>Login e inicio de sesión</li> <li>Registro de usuarios</li> <li>Recuperación de contraseña olvidada</li> <li>Confirmación de registro mediante email</li> <li>Etc.</li> </ul> <p>Para instalar Laravel Breeze:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ composer require laravel/breeze --dev
$ php artisan breeze:install
$ npm install
$ npm run dev
</code></pre></div></div> <p>Laravel Breeze crea automáticamente varias rutas en /routes/auth.php, entre ellas:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Routes</span><span class="o">::</span><span class="nf">get</span><span class="p">(</span><span class="s2">"/login"</span><span class="p">)</span> <span class="err">→</span> <span class="nc">Para</span> <span class="n">mostrar</span> <span class="n">el</span> <span class="n">formulario</span> <span class="n">de</span> <span class="n">login</span>
<span class="nc">Routes</span><span class="o">::</span><span class="nf">post</span><span class="p">(</span><span class="s2">"/login"</span><span class="p">)</span> <span class="err">→</span> <span class="nc">Para</span> <span class="n">procesar</span> <span class="n">el</span> <span class="n">formulario</span> <span class="n">de</span> <span class="n">login</span>
<span class="nc">Routes</span><span class="o">::</span><span class="nf">post</span><span class="p">(</span><span class="s2">"/logout"</span><span class="p">)</span> <span class="err">→</span> <span class="nc">Para</span> <span class="n">cerrar</span> <span class="n">la</span> <span class="n">sesión</span>
<span class="nc">Routes</span><span class="o">::</span><span class="nf">get</span><span class="p">(</span><span class="s2">"/register"</span><span class="p">)</span> <span class="err">→</span> <span class="nc">Para</span> <span class="n">mostrar</span> <span class="n">el</span> <span class="n">fomulario</span> <span class="n">de</span> <span class="n">registro</span>
<span class="nc">Routes</span><span class="o">::</span><span class="nf">post</span><span class="p">(</span><span class="s2">"/register"</span><span class="p">)</span> <span class="err">→</span> <span class="nc">Para</span> <span class="n">procesar</span> <span class="n">el</span> <span class="n">formulario</span> <span class="n">de</span> <span class="n">registro</span>
</code></pre></div></div> <p>También se crean varios controladores como LoginController y RegisterContoller: están en App/Http/Controllers/Auth.</p> <p>Y se crean varias vistas, como auth/login.blade.php, register.blade.php y layouts/app.blade.php (la plantilla que usarán login y register)</p> <p>Por último, se crea una vista HOME de ejemplo (dashboard.blade.php) a la que llegamos después de hacer login. Esa vista HOME la puedes cambiar en /app/providers/RouteServiceProvider.php</p> <p>¡Y listo! Solo nos queda adaptar estas vistas y controladores a nuestras necesidades.</p> <h4 id="51331-autenticación-y-vistas-cómo-generar-código-dependiendo-del-tipo-de-usuario"> <a href="#51331-autenticación-y-vistas-cómo-generar-código-dependiendo-del-tipo-de-usuario" class="anchor-heading" aria-labelledby="51331-autenticación-y-vistas-cómo-generar-código-dependiendo-del-tipo-de-usuario"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5.13.3.1. Autenticación y vistas: cómo generar código dependiendo del tipo de usuario </h4> <p>En las vistas, tenemos un par de directivas de Blade muy útiles relacionadas con las sesiones.</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="o">@</span><span class="n">auth</span>
   <span class="mf">...</span>   <span class="c1">// Este código se ejecuta si existe un usuario logueado</span>
   <span class="o">@</span><span class="n">endauth</span>
   <span class="o">@</span><span class="n">guest</span>
   <span class="mf">...</span>   <span class="c1">// Este código se ejecuta si NO existe usuario logueado</span>
   <span class="o">@</span><span class="n">endguest</span>
</code></pre></div></div> <p>Además, podemos acceder a los datos del usuario mediante la clase Auth:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Auth</span><span class="o">::</span><span class="nf">user</span><span class="p">()</span> <span class="err">→</span> <span class="nc">Devuelve</span> <span class="n">el</span> <span class="n">usuario</span> <span class="n">actualmente</span> <span class="n">logueado</span> <span class="n">o</span> <span class="kc">null</span> <span class="n">si</span> <span class="n">no</span> <span class="n">hay</span> <span class="n">ninguna</span> <span class="n">sesión</span> <span class="n">abierta</span><span class="mf">.</span>
<span class="nc">Auth</span><span class="o">::</span><span class="nf">check</span><span class="p">()</span> <span class="err">→</span> <span class="nc">Devuelve</span> <span class="kc">true</span> <span class="n">si</span> <span class="n">el</span> <span class="n">usuario</span> <span class="n">actual</span> <span class="n">está</span> <span class="n">logueado</span><span class="mf">.</span>
</code></pre></div></div> <p>(Más métodos de Auth en https://laravel.com/docs/8.x/authentication)</p> <h4 id="51332-autenticación-y-middlewares-cómo-proteger-los-controladores"> <a href="#51332-autenticación-y-middlewares-cómo-proteger-los-controladores" class="anchor-heading" aria-labelledby="51332-autenticación-y-middlewares-cómo-proteger-los-controladores"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5.13.3.2. Autenticación y middlewares: cómo proteger los controladores </h4> <p>Los middlewares son componentes software de Laravel que capturan y filtran todas las peticiones HTTP que llegan a la aplicación. Están ubicados en App/Http/Middleware.</p> <p>Hay dos middlewares relacionados con la autenticación en Laravel: Authenticate (alias “auth”) y RedirectIfAuthenticated (alias “guest”). Los alias se definen en App/Http/Kernel.php.</p> <p>Podemos usar estos middlewares en el constructor de nuestros controladores para protegerlos en todo o en parte:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// Solo usuarios logueados podrán acceder a este controlador:</span>
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">middleware</span><span class="p">(</span><span class="s2">"auth"</span><span class="p">);</span> 
      <span class="c1">// Solo usuarios logueados podrán acceder a los métodos create() y edit():</span>
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">middleware</span><span class="p">(</span><span class="s2">"auth"</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">only</span><span class="p">(</span><span class="s2">"create"</span><span class="p">,</span> <span class="s2">"edit"</span><span class="p">);</span>
      <span class="c1">// Solo usuarios logueados podrán acceder al controlador excepto a show():</span>
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">middleware</span><span class="p">(</span><span class="s2">"auth"</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">except</span><span class="p">(</span><span class="s2">"show"</span><span class="p">);</span>
   <span class="p">}</span>
</code></pre></div></div> <p>El middleware auth también puede usarse en el enrutador, para proteger todo el controlador, así:</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="nc">Route</span><span class="o">::</span><span class="nf">get</span><span class="p">(</span><span class="s1">'/ruta-a-proteger'</span><span class="p">,</span> <span class="s1">'Controlador@metodo'</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">middleware</span><span class="p">(</span><span class="s1">'auth'</span><span class="p">);</span>
</code></pre></div></div> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
