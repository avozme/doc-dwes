I"Ç%<h2 class="no_toc" id="12-wordpress">1.2. Wordpress</h2>

<ul id="markdown-toc">
  <li><a href="#121-caracter√≠sticas-principales-de-wordpress" id="markdown-toc-121-caracter√≠sticas-principales-de-wordpress">1.2.1. Caracter√≠sticas principales de Wordpress</a>    <ul>
      <li><a href="#funcionalidades-de-wordpress" id="markdown-toc-funcionalidades-de-wordpress"><strong>Funcionalidades de Wordpress</strong></a></li>
      <li><a href="#plantillas-de-wordpress" id="markdown-toc-plantillas-de-wordpress"><strong>Plantillas de Wordpress</strong></a></li>
      <li><a href="#widgets" id="markdown-toc-widgets"><strong>Widgets</strong></a></li>
      <li><a href="#plugins" id="markdown-toc-plugins"><strong>Plugins</strong></a></li>
      <li><a href="#fallos-de-seguridad-de-wordpress" id="markdown-toc-fallos-de-seguridad-de-wordpress"><strong>Fallos de seguridad de Wordpress</strong></a></li>
    </ul>
  </li>
  <li><a href="#122-c√≥mo-crear-y-modificar-una-plantilla-de-wordpress" id="markdown-toc-122-c√≥mo-crear-y-modificar-una-plantilla-de-wordpress">1.2.2. C√≥mo crear y modificar una plantilla de Wordpress</a>    <ul>
      <li><a href="#las-plantillas-o-temas-de-wordpress" id="markdown-toc-las-plantillas-o-temas-de-wordpress"><strong>Las plantillas o temas de WordPress</strong></a></li>
      <li><a href="#d√≥nde-localizar-las-plantillas-instaladas" id="markdown-toc-d√≥nde-localizar-las-plantillas-instaladas"><strong>D√≥nde localizar las plantillas instaladas</strong></a></li>
      <li><a href="#archivos-de-un-tema-de-wordpress" id="markdown-toc-archivos-de-un-tema-de-wordpress"><strong>Archivos de un tema de WordPress</strong></a></li>
      <li><a href="#paso-1-crear-el-archivo-stylecss" id="markdown-toc-paso-1-crear-el-archivo-stylecss"><strong>Paso 1: Crear el archivo style.css</strong></a></li>
      <li><a href="#paso-2-im√°genes-y-javascript" id="markdown-toc-paso-2-im√°genes-y-javascript"><strong>Paso 2: Im√°genes y JavaScript</strong></a></li>
      <li><a href="#paso-3-crear-la-cabecera-del-tema-y-el-men√∫-de-navegaci√≥n" id="markdown-toc-paso-3-crear-la-cabecera-del-tema-y-el-men√∫-de-navegaci√≥n"><strong>Paso 3: Crear la cabecera del tema y el men√∫ de navegaci√≥n</strong></a></li>
      <li><a href="#paso-4-crear-la-barra-lateral" id="markdown-toc-paso-4-crear-la-barra-lateral"><strong>Paso 4: Crear la barra lateral</strong></a></li>
      <li><a href="#paso-5-crear-el-footer" id="markdown-toc-paso-5-crear-el-footer"><strong>Paso 5: Crear el footer</strong></a></li>
      <li><a href="#paso-6-crear-la-p√°gina-principal" id="markdown-toc-paso-6-crear-la-p√°gina-principal"><strong>Paso 6: Crear la p√°gina principal</strong></a></li>
      <li><a href="#paso-7-el-loop-de-wordpress" id="markdown-toc-paso-7-el-loop-de-wordpress"><strong>Paso 7. El loop de WordPress</strong></a></li>
      <li><a href="#paso-8-a√±adir-thumbnails-al-loop" id="markdown-toc-paso-8-a√±adir-thumbnails-al-loop"><strong>Paso 8. A√±adir thumbnails al loop</strong></a></li>
      <li><a href="#paso-9-resultados-de-la-b√∫squeda" id="markdown-toc-paso-9-resultados-de-la-b√∫squeda"><strong>Paso 9. Resultados de la b√∫squeda</strong></a></li>
      <li><a href="#paso-10-configurar-la-vista-de-las-entradas-posts" id="markdown-toc-paso-10-configurar-la-vista-de-las-entradas-posts"><strong>Paso 10. Configurar la vista de las entradas (posts)</strong></a></li>
      <li><a href="#paso-11-habilitar-y-mostrar-los-comentarios" id="markdown-toc-paso-11-habilitar-y-mostrar-los-comentarios"><strong>Paso 11: Habilitar y mostrar los comentarios</strong></a></li>
      <li><a href="#paso-12-crear-la-p√°gina-de-categor√≠as-y-etiquetas" id="markdown-toc-paso-12-crear-la-p√°gina-de-categor√≠as-y-etiquetas"><strong>Paso 12: Crear la p√°gina de categor√≠as y etiquetas</strong></a></li>
      <li><a href="#y-ahora-qu√©" id="markdown-toc-y-ahora-qu√©"><strong>¬øY ahora qu√©?</strong></a></li>
    </ul>
  </li>
  <li><a href="#123-plugins-de-wordpress" id="markdown-toc-123-plugins-de-wordpress">1.2.3. Plugins de Wordpress</a>    <ul>
      <li><a href="#los-plugins-de-wordpress" id="markdown-toc-los-plugins-de-wordpress"><strong>Los plugins de WordPress</strong></a></li>
      <li><a href="#crear-un-plugin-nuevo" id="markdown-toc-crear-un-plugin-nuevo"><strong>Crear un plugin nuevo</strong></a></li>
      <li><a href="#a√±adir-funciones-al-plugin" id="markdown-toc-a√±adir-funciones-al-plugin"><strong>A√±adir funciones al plugin</strong></a></li>
      <li><a href="#instalar-y-desinstalar-el-plugin" id="markdown-toc-instalar-y-desinstalar-el-plugin"><strong>Instalar y desinstalar el plugin</strong></a></li>
      <li><a href="#c√≥mo-usar-las-funciones-del-plugin" id="markdown-toc-c√≥mo-usar-las-funciones-del-plugin"><strong>C√≥mo usar las funciones del plugin</strong></a></li>
      <li><a href="#configurar-el-plugin-desde-el-panel-de-administraci√≥n" id="markdown-toc-configurar-el-plugin-desde-el-panel-de-administraci√≥n"><strong>Configurar el plugin desde el panel de administraci√≥n</strong></a></li>
      <li><a href="#acceder-a-la-bd-desde-nuestro-plugin" id="markdown-toc-acceder-a-la-bd-desde-nuestro-plugin"><strong>Acceder a la BD desde nuestro plugin</strong></a></li>
    </ul>
  </li>
</ul>

<p>Wordpress es sin duda el campe√≥n actual de los CMS. Algunas estad√≠sticas afirman que el 90% de los sitios web de internet est√° hecho con Wordpress. Probablemente son estad√≠sticas un poco infladas, pero la importancia de este CMS es innegable y cualquier desarrollador web debe conocerlo, aunque sea para odiarlo.</p>

<p>Wordpress es un CMS enfocado a la creaci√≥n de blogs, aunque, en su estadio actual, permite crear casi cualquier tipo de sitio web: tiendas online, portales, revistas digitales, √°lbumes de im√°genes o recursos de cualquier tipo‚Ä¶</p>

<p>Est√° desarrollado en PHP bajo licencia GPL y se ha convertido. Tiene detr√°s una enorme comunidad de desarrolladores y dise√±adores, que se encargan de actualizarlo y de crear plugins y temas para la comunidad.</p>

<h3 id="121-caracter√≠sticas-principales-de-wordpress">1.2.1. Caracter√≠sticas principales de Wordpress</h3>

<ul>
  <li>La est√©tica, tanto de resultado como del c√≥digo fuente, es fundamental para los desarrolladores de WordPress.</li>
  <li>Las entradas publicadas son ordenadas por fecha, aunque esto se puede modificar.</li>
  <li>La estructura y dise√±o visual del sitio depende del sistema de plantillas.</li>
  <li>La filosof√≠a de Wordpress apuesta decididamente por la elegancia, la sencillez y las recomendaciones del W3C pero depende siempre de la plantilla.</li>
  <li>Separa el contenido y el dise√±o en XHTML y CSS, aunque, como se ha dicho, depende de la plantilla que se est√© usando.</li>
  <li>La gesti√≥n y ejecuci√≥n corre a cargo del sistema de administraci√≥n con los plugins y los widgets que usan las plantillas.</li>
</ul>

<h4 id="funcionalidades-de-wordpress"><strong>Funcionalidades de Wordpress</strong></h4>

<p>Wordpress hace magia. As√≠ de sencillo.</p>

<p>Si te vas a convertir en desarrollador/a web, Wordpress es tu peor enemigo, porque permite que cualquier usuario medio, sin tener ni idea de programaci√≥n, pueda crear un sitio web solvente y de aspecto profesional en una tarde.</p>

<p>No te voy a enga√±ar: a ti te llevar√≠a meses programar algo parecido desde cero.</p>

<p>Pero Wordpress tambi√©n tiene sus limitaciones, y cuando sus usuarios las descubren, necesitan a un programador que sepa meterse en las tripas de Wordpress para retorc√©rselas. Ah√≠ es donde entrar√°s t√∫.</p>

<p>De modo que s√≠: Wordpress es tu peor enemigo, pero puede convertirse en tu mejor aliado.</p>

<p>Para eso, tienes que conocer qu√© es capaz de hacer y qu√© no. Entre sus asombrosas funciones podemos contar estas:</p>

<ul>
  <li>F√°cil instalaci√≥n, actualizaci√≥n y personalizaci√≥n.</li>
  <li>Posibilidad de actualizaci√≥n autom√°tica del sistema implementada en la versi√≥n 2.7.</li>
  <li>M√∫ltiples autores o usuarios, junto con sus roles o perfiles que establecen distintos niveles de permisos desde la versi√≥n 2.0).</li>
  <li>M√∫ltiples blogs o bit√°coras (desde la versi√≥n 1.6).</li>
  <li>Capacidad de crear p√°ginas est√°ticas (a partir de la versi√≥n 1.5).</li>
  <li>Permite ordenar art√≠culos y p√°ginas est√°ticas en categor√≠as, subcategor√≠as y etiquetas (‚Äútags‚Äù).</li>
  <li>Cuatro estados para una entrada (‚Äúpost‚Äù): Publicado, Borrador, Esperando Revisi√≥n (nuevo en Wordpress 2.3) y Privado (s√≥lo usuarios registrados), adem√°s de uno adicional: Protegido con contrase√±a.</li>
  <li>Editor WYSIWYG ‚ÄúWhat You See Is What You Get‚Äù en ingl√©s, ‚Äúlo que ves es lo que obtienes‚Äù (desde la versi√≥n 2.0).</li>
  <li>Publicaci√≥n mediante email.</li>
  <li>Importaci√≥n desde Blogger, Blogware, Dotclear, Greymatter, Livejournal, Movable Type y Typepad, Textpattern y desde cualquier fuente RSS. Se est√° trabajando para poder importar desde pMachine y Nucleus adem√°s de la importaci√≥n a trav√©s de scripts o directamente de base de datos.</li>
  <li>Guardado autom√°tico temporizado del art√≠culo como Borrador (A partir de la versi√≥n 2.2).</li>
  <li>Permite comentarios y herramientas de comunicaci√≥n entre blogs (Trackback, Pingback, etc).</li>
  <li>Permite ‚Äúpermalinks‚Äù (enlaces permanentes y f√°ciles de recordar) mediante mod_rewrite.</li>
  <li>Distribuci√≥n de los art√≠culos mediante RDF, RSS 0.92, RSS 2.0 y Atom 1.0.</li>
  <li>Distribuci√≥n de las discusiones (mediante RSS 2.0 y ATOM 1.0).</li>
  <li>Gesti√≥n y distribuci√≥n de enlaces.</li>
  <li>Subida y gesti√≥n de adjuntos y archivos multimedia.</li>
  <li>Admite plugins para aumentar a√∫n m√°s la fucionalidad, a riesgo de convertirlo en una ‚Äúmonstruo de Frankenstein‚Äù hecho a pegotes.</li>
  <li>Admite plantillas y ‚ÄúWidgets‚Äù para √©stas.</li>
  <li>B√∫squeda en entradas y p√°ginas est√°ticas y Widget de casa para b√∫squeda integrada de google desde la versi√≥n 2.5.[5]</li>
</ul>

<h4 id="plantillas-de-wordpress"><strong>Plantillas de Wordpress</strong></h4>

<p>Las plantillas (themes) de Wordpress son dise√±os CSS que sirven para establecer la apariencia y estructura del blog. Algunas tambi√©n modifican parte del panel de administraci√≥n.</p>

<p>Hay una gran comunidad oficial, tanto profesional como de usuarios, dedicada al dise√±o de estas plantillas. Puedes encontrarlas tanto en el sitio de Wordpress (comprobadas y aprobadas oficialmente) como en sitios web de terceros. Muchas son gratuitas, otras de pago y, la mayor√≠a, tienen una versi√≥n gratuita con funciones adicionales de pago.</p>

<p>Las posibilidades de las plantillas, tanto a nivel de dise√±o, estructura o gesti√≥n, son tan grandes que pr√°cticamente permiten tener desde un simple blog hasta un portal web fuertemente personalizable.</p>

<p>Hay un gran campo de trabajo en las plantillas de Wordpress para un desarrollador web. M√°s adelante veremos como crear plantillas nuevas, algo que tambi√©n te servir√° para modificar plantillas existentes.</p>

<h4 id="widgets"><strong>Widgets</strong></h4>

<p>Los widgets son peque√±as aplicaciones que proporcionan nuevas funcionalidades a un programa o que permiten un acceso r√°pido a funcionalidades usadas con frecuencia.</p>

<p>Pueden ser vistosos como, por ejemplo, relojes en pantalla, calculadoras, calendarios o nubes de tags; o pueden ser discretos pero √∫tiles como, por ejemplo, un cuadro con enlaces de inter√©s o con un contador del n√∫mero de visitas.</p>

<p>Wordpress incorpora un sistema de widgets para sus plantillas que ofrece numerosas posibilidades y flexibilidad para el dise√±o y estructura de sus blogs. Cada plantilla puede soportar un n√∫mero diferente de Widgets.</p>

<h4 id="plugins"><strong>Plugins</strong></h4>

<p>Hay una monstruosa cantidad de plugins que potencian el uso de Wordpress y que lo convierten en un CMS pr√°cticamente de prop√≥sito general. Encontrar√°s un plugin para casi cualquier cosa que se te ocurra.</p>

<p>Pero (¬°siempre hay un pero!) con los plugins se corre el riesgo de empezar a parchear Wordpress hasta convertirlo en un amasijo informe de c√≥digo puesto a pegotones. Muchos sitios web montados con Wordpress se vuelven ingobernables (y extraordinariamente lentos y pesados en la carga) por la gran cantidad de plugins que tienen activados.</p>

<p>Otro problema de los plugins es que pueden provocar incontables problemas con las actualizaciones del sistema.</p>

<p>En el √°mbito de los plugins tambi√©n hay mucho trabajo potencial para un futuro desarrollador/a web como t√∫: tanto para crear plugins nuevos y adaptados a las necesidades del cliente como para optimizar y racionalizar el uso de plugins existentes en los sitios que ya est√°n en funcionamiento.</p>

<p>Por √∫ltimo, y al igual que ocurr√≠a con las plantillas, tienes que saber que muchos plugins son gratuitos, otros son de pago, y otros tienen versiones gratuitas que se vuelven de pago cuando queremos utilizar sus caracter√≠sticas m√°s atractivas.</p>

<h4 id="fallos-de-seguridad-de-wordpress"><strong>Fallos de seguridad de Wordpress</strong></h4>

<p>Las cr√≠ticas m√°s contundentes contra WordPress se han centrado en sus problemas de seguridad. En mayo de 2007, por ejemplo, un estudio revel√≥ que el 98% de los blogs basados en WordPress eran vulnerables a ataques.</p>

<p>Todos los sistemas que se vuelven muy populares se vuelven inseguros por el simple hecho de que se multiplican los ataques contra ellos.</p>

<p>La receta para minimizar los posibles problemas de seguridad es sencilla: mantener Wordpress actualizado. No podemos hacer mucho m√°s all√° de eso.</p>

<h3 id="122-c√≥mo-crear-y-modificar-una-plantilla-de-wordpress">1.2.2. C√≥mo crear y modificar una plantilla de Wordpress</h3>

<p>(Esta secci√≥n est√° redactada a partir de esandra.com/crear-plantilla-wordpress-desde-cero y de manuelvicedo.com/guias/personalizar-wordpress-plantillas)</p>

<p>Vamos a ver que Wordpress dispone de una enorme API de funciones √∫tiles para desarrollar nuestros propios temas y plugins. Y lo vamos a ver de forma pr√°ctica: creando nuestra propia plantilla desde cero.</p>

<h4 id="las-plantillas-o-temas-de-wordpress"><strong>Las plantillas o temas de WordPress</strong></h4>

<p>Como ya hemos dicho, existen muchos sitios web donde adquirir plantillas (themes) de WordPress de gran valor a√±adido. Algunas son gratuitas, otras de pago, y otras tienen versiones gratuitas incompletas o parcialmente desactivadas, y versiones de pago que permiten usar todas las funcionalidades.</p>

<p>Pero, a veces, queremos ir un paso m√°s all√° y desarrollar nuestro propio tema. Para ello, se puede usar un framework como Thematic o partir de un tema b√°sico, pensado para desarrollo. Existen muchos temas de ese tipo, algunos muy conocidos, como Bones o Basic.</p>

<p>A veces es mejor desarrollar un tema de WordPress desde cero, pues as√≠ conseguimos adaptarlo exactamente a lo que estamos buscando, evitando llamar a un mont√≥n de funciones innecesarias para las prestaciones que necesitamos. Adem√°s, as√≠ tendremos el control abosluto sobre los archivos y contenidos de la plantilla.</p>

<h4 id="d√≥nde-localizar-las-plantillas-instaladas"><strong>D√≥nde localizar las plantillas instaladas</strong></h4>

<p>Suponiendo que tenemos WordPress instalado y en correcto funcionamiento en un servidor (local o remoto, da lo mismo), lo primero que tendremos que hacer es ir al directorio que contiene los temas de WordPress. Este directorio se encuentra en las siguiente ruta: directoriowordpress -&gt; wp-content -&gt; themes, siendo directoriowordpress el directorio donde tenemos instalado WordPress dentro del htdocs del servidor.</p>

<p>Dentro del directorio themes veremos una carpeta para cada tema de WordPress. Ah√≠ tendremos que crear una nueva carpeta con el nombre de nuestro nuevo tema.</p>

<p>A partir de ahora supondremos que estamos creando un nuevo tema llamado <strong><em>mitema</em></strong>. Es decir, dentro de themes tendremos que crear un directorio llamado ‚Äúmitema‚Äù.</p>

<h4 id="archivos-de-un-tema-de-wordpress"><strong>Archivos de un tema de WordPress</strong></h4>

<p>WordPress funciona por m√≥dulos. Por ejemplo, para insertar el footer en una p√°gina habremos de llamar al archivo footer.php, en caso de que exista. Y lo mismo con el header, la barra de navegaci√≥n, etc.</p>

<p>As√≠, un tema de WordPress puede estar formado por muchos archivos, pero para que un tema de WordPress funcione, <strong>s√≥lo necesitar√° dos archivos: index.php y style.css</strong>. Est√° claro que con s√≥lo estos dos archivos tendremos un tema muy b√°sico, pero ser√° considerado por WordPress un tema v√°lido si estos dos archivos est√°n bien configurados.</p>

<p>Para que un tema de WordPress sea reconocido por WordPress deber√° incluir s√≠ o s√≠ estos dos archivos, index.php y style.css. Si falta cualquiera de ellos, WordPress no reconocer√° la carpeta mitema como un tema de WordPress.</p>

<p>A continuaci√≥n vamos a desarrollar un tema m√°s completo que nos sirva de base para otros proyectos. Y raramente crearemos un tema de WordPress que no contenga una cabecera, un footer y una barra lateral, como m√≠nimo. Tampoco vamos aqu√≠ a desarrollar un tema complejo con funciones avanzadas, pero s√≠ que queremos tener lo necesario para crear un tema decente con el que poder desarrollar proyectos m√°s complejos.</p>

<p>As√≠, vamos a desarrollar un tema con la mayor√≠a de archivos y carpetas habituales en otros temas para WordPress profesionales. Son los siguientes:</p>

<ul>
  <li>/images. Carpeta con las im√°genes del tema.</li>
  <li>/js. Carpeta con los archivos de JavaScript</li>
  <li>style.css. Hoja de estilos del tema. Obligatoria para que el tema funcione.</li>
  <li>index.php. Obligatorio para que el tema funcione. Por defecto ser√° la p√°gina principal.</li>
  <li>screenshot.png. Muestra la imagen en miniatura que se ver√° en el panel de administraci√≥n en Apariencia -&gt; Temas.</li>
  <li>favicon.ico. La imagen que se ver√° en el navegador y al guardar el marcador.</li>
  <li>header.php. M√≥dulo que contiene la cabecera del tema.</li>
  <li>sidebar.php. La barra lateral del tema.</li>
  <li>footer.php. M√≥dulo que contiene el pie de p√°gina del tema.</li>
  <li>single.php. Este archivo especifica c√≥mo se ver√° una entrada.</li>
  <li>page.php. Este archivo especifica c√≥mo se ver√° una p√°gina est√°tica.</li>
  <li>category.php. Muestra c√≥mo se ve la p√°gina de resultados de una categor√≠a.</li>
  <li>tag.php. Muestra c√≥mo se ve la p√°gina de resultados de una etiqueta.</li>
  <li>search.php. Muestra c√≥mo se ve la p√°gina de resultados de b√∫squeda.</li>
  <li>functions.php. Archivo con las funciones gen√©ricas de nuestro tema de WordPress.</li>
</ul>

<p>En la plantilla que vamos a desarrollar utilizaremos pr√°cticamente todos estos archivos, para que veamos que no es tan complejo como de entrada pueda parecer.</p>

<p>A partir de ah√≠, es fundamental tener la capacidad de crear un buen c√≥digo HTML y CSS para obtener resultados profesionales.</p>

<p>Para no perdernos en la inmensidad y hacer f√°cil lo supuestamente dif√≠cil, vamos a aplicar la t√©cnica del divide y vencer√°s dividiendo la creaci√≥n de la plantilla en 11 pasos</p>

<h4 id="paso-1-crear-el-archivo-stylecss"><strong>Paso 1: Crear el archivo style.css</strong></h4>

<p>El primer paso va a consistir en crear dentro de la carpeta ‚Äúmitema‚Äù el archivo <strong><em>style.css</em></strong>.</p>

<p>Es recomendable utilizar un buen editor de textos para desarrollo web, como Sublime Text 2 o Notepad++, pero puedes hacerlo incluso con el Bloc de Notas de Windows si te va la marcha.</p>

<p>Dentro del archivo style.css, en la parte superior deberemos incluir esta informaci√≥n:</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="c">/*
	Theme Name: Mitema
	Theme URI: el lugar donde vayas a alojar el tema 
                 para ponerlo a disposici√≥n de la comunidad
	Description: La descripci√≥n del tema
	Author: Tu nombre y apellidos
	Author URI: la web profesional del creador del tema
            Version: 1.0
	*/</span>
</code></pre></div></div>

<p>F√≠jate que este fragmento de texto est√° comentado con /* ‚Ä¶ */. Todos los datos que ponemos aqu√≠ van a aparecer junto al tema en Apariencia -&gt; Temas.</p>

<p>A partir de aqu√≠, podemos ya crear nuestro propio c√≥digo de CSS.</p>

<h4 id="paso-2-im√°genes-y-javascript"><strong>Paso 2: Im√°genes y JavaScript</strong></h4>

<p>Este tema lo vamos a desarrollar con HTML5. Vamos a utilizar Modernizr, una librer√≠a de JavaScript que detecta las capacidades de HTML5 y CSS3 del navegador. Tambi√©n haremos uso de Respond, otra librer√≠a JavaScript que sirve para que Internet Explorer sepa interpretar los media queries de CSS3. De ese modo, nuestro tema funcionar√° incluso en navegadores muy antiguos.</p>

<p>Por supuesto, puede crearse un tema sin estas librer√≠as, pero las usaremos para ilustrar c√≥mo se puede incrustar JavaScript en una plantilla WP.</p>

<p>Crearemos las carpetas ‚Äúimages‚Äù y ‚Äújs‚Äù dentro de la carpeta ‚Äúmitema‚Äù.</p>

<p>En la carpeta ‚Äújs‚Äù pondremos una copia de las librer√≠as Modernizr y Respond bajadas directamente de las webs de los desarrolladores.</p>

<p>En la carpeta ‚Äúimages‚Äù colocaremos m√°s adelantes todas las im√°genes que vayamos necesitando para nuestro CSS. Ten en cuenta que dos archivos llamados <strong><em>screenshot.png</em></strong> y el <strong><em>favicon.ico</em></strong> se han de ubicar en la ra√≠z del tema y no dentro de la carpeta images. Wordpress utilizar√° estos dos archivos para la previsualizaci√≥n del tema y para el icono de la p√°gina una vez que el tema se active.</p>

<h4 id="paso-3-crear-la-cabecera-del-tema-y-el-men√∫-de-navegaci√≥n"><strong>Paso 3: Crear la cabecera del tema y el men√∫ de navegaci√≥n</strong></h4>

<p>El archivo header.php contiene la cabecera de nuestro tema. Es aqu√≠ donde pondremos nuestro logo, men√∫ principal y aquello que aparezca en la parte superior de nuestro tema. Veamos un c√≥digo posible para header.php:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="cp">&lt;!DOCTYPE html&gt;</span>
	<span class="nt">&lt;html</span> <span class="err">&lt;?</span><span class="na">php</span> <span class="na">language_attributes</span><span class="err">();</span> <span class="err">?</span><span class="nt">&gt;</span>&gt;
	<span class="nt">&lt;head&gt;</span>
	  <span class="nt">&lt;meta</span> <span class="na">charset= </span><span class="s">&lt;?php</span> <span class="na">bloginfo</span><span class="err">(</span> <span class="err">'</span><span class="na">charset</span><span class="err">'</span> <span class="err">);</span> <span class="err">?</span><span class="nt">&gt;</span>"&gt;
	  <span class="nt">&lt;title&gt;</span><span class="cp">&lt;?php wp_title(); ?&gt;</span><span class="nt">&lt;/title&gt;</span>
	  <span class="c">&lt;!-- Definir viewport para dispositivos web m√≥viles --&gt;</span>
	  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, minimum-scale=1"</span><span class="nt">&gt;</span>
	  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"shortcut icon"</span> <span class="na">href=</span><span class="s">"&lt;?php echo get_stylesheet_directory_uri(); ?&gt;/favicon.ico"</span> <span class="nt">/&gt;</span>
	  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">media=</span><span class="s">"all"</span> <span class="na">href=</span><span class="s">"&lt;?php bloginfo( 'stylesheet_url' ); ?&gt;"</span> <span class="nt">/&gt;</span>
	  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"pingback"</span> <span class="na">href=</span><span class="s">"&lt;?php bloginfo( 'pingback_url' ); ?&gt;"</span> <span class="nt">/&gt;</span>
	  <span class="cp">&lt;?php wp_head(); ?&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
	  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"wrapper"</span><span class="nt">&gt;</span>
	    <span class="nt">&lt;header&gt;</span>
	      <span class="nt">&lt;h1&gt;&lt;a</span> <span class="na">href=</span><span class="s">"&lt;?php echo get_option('home'); ?&gt;"</span><span class="nt">&gt;</span><span class="cp">&lt;?php bloginfo('name'); ?&gt;</span><span class="nt">&lt;/a&gt;&lt;/h1&gt;</span>
	      <span class="nt">&lt;hr&gt;</span>
	      <span class="cp">&lt;?php wp_nav_menu( array('menu' =&gt; 'Main', 'container' =&gt; 'nav' )); ?&gt;</span>
	    <span class="nt">&lt;/header&gt;</span>
</code></pre></div></div>

<p>Si analizas el c√≥digo, ver√°s que, despu√©s del doctype, hemos abierto la etiqueta html indicando que seleccione los atributos de idioma de la instalaci√≥n de WordPress.</p>

<p>Para el charset tambi√©n hemos recurrido a una funci√≥n de Wordpress, as√≠ como para el t√≠tulo de la p√°gina.</p>

<p>En el caso de estar dise√±ando un tema responsive, especificaremos el viewport.</p>

<p>Para mostrar la URL al favicon.ico le indicamos la ruta a la carpeta ‚Äúmitema‚Äù de la instalaci√≥n de WordPress. Eso se consigue con la funci√≥n de Wordpress get_stylesheet_directory_uri().</p>

<p>Un poco m√°s abajo se usa la funci√≥n bloginfo() con el argumento ‚Äòstylesheet_directory‚Äô, que tiene el mismo efecto que get_stylesheet_directory_uri().</p>

<p>Finalmente, se usa la funci√≥n wp_head() de WordPress, necesaria par que muchos plugins y funcionalidades de WordPress funcionen. A partir de aqu√≠ cerramos la etiqueta head y empezamos con los contenidos de body.</p>

<p>Quiz√°s aqu√≠ te est√©s preguntando por qu√© incluir el body en header.php y no en index.php. La raz√≥n es sencilla: los contenidos de la cabecera del tema van a estar en todas las p√°ginas, por lo que al incluirlo aqu√≠, evitamos duplicar c√≥digo y el mantenimiento del tema va a ser mucho m√°s sencillo. As√≠, dentro de las etiquetas de header incluiremos nuestra cabecera. En este ejemplo, hemos puesto el nombre del sitio web con un enlace a la p√°gina de inicio:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="nt">&lt;h1&gt;&lt;a</span> <span class="na">href=</span><span class="s">"&lt;?php echo get_option('home'); ?&gt;"</span><span class="nt">&gt;</span><span class="cp">&lt;?php bloginfo('name'); ?&gt;</span><span class="nt">&lt;/a&gt;&lt;/h1&gt;</span>
</code></pre></div></div>

<p>F√≠jate que en la etiqueta header hemos escrito esta l√≠nea:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="cp">&lt;?php</span> <span class="nf">wp_nav_menu</span><span class="p">(</span> <span class="k">array</span><span class="p">(</span><span class="s1">'menu'</span> <span class="o">=&gt;</span> <span class="s1">'Main'</span><span class="p">,</span> <span class="s1">'container'</span> <span class="o">=&gt;</span> <span class="s1">'nav'</span> <span class="p">));</span> <span class="cp">?&gt;</span>
</code></pre></div></div>

<p>Eso deber√≠a crear el men√∫ de navegaci√≥n, pero, para que funcione, primero deberemos a√±adir al archivo <strong><em>functions.php</em></strong> (que contiene las funciones propias del tema) este c√≥digo:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="cp">&lt;?php</span>
	<span class="c1">// Registro del men√∫ de WordPress</span>
	<span class="nf">add_theme_support</span><span class="p">(</span> <span class="s1">'nav-menus'</span> <span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span> <span class="nb">function_exists</span><span class="p">(</span> <span class="s1">'register_nav_menus'</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
	    <span class="nf">register_nav_menus</span><span class="p">(</span>
	        <span class="k">array</span><span class="p">(</span>
	          <span class="s1">'main'</span> <span class="o">=&gt;</span> <span class="s1">'Main'</span>
	        <span class="p">)</span>
	    <span class="p">);</span>
	<span class="p">}</span>
	<span class="cp">?&gt;</span>
</code></pre></div></div>

<p>Este c√≥digo lo que hace es crear un men√∫ llamado ‚ÄúMain‚Äù que nos aparecer√° en el panel de administraci√≥n de WordPress en Apariencia -&gt; Men√∫s. Lo que este c√≥digo dice es que si existe una funci√≥n llamada register_nav_menus, entonces debe crearse un nuevo men√∫ de navegaci√≥n llamado Main. Adem√°s, la funci√≥n de Wordpress add_theme_support() sirve para indicar que en este tema queremos poder crear men√∫s din√°micos.</p>

<p>A partir de aqu√≠, simplemente habremos de ir a Apariencia -&gt; Men√∫s y crear nuestro men√∫ y guardarlo, como con cualquier otro theme.</p>

<p>Con esto ya tenemos la cabecera del tema creada junto con su men√∫ de navegaci√≥n. Recuerda que para a√±adir p√°ginas al men√∫ de WordPress, primero hay que crear las p√°ginas o no podremos hacerlo.</p>

<h4 id="paso-4-crear-la-barra-lateral"><strong>Paso 4: Crear la barra lateral</strong></h4>

<p>La mayor√≠a de temas de WordPress incluyen una barra lateral que no tiene por qu√© aparecer en todas las p√°ginas del tema. En las barras laterales acostumbramos a poder a√±adir widgets, por lo que se van a tener que habilitar para widgets. Para ello, abriremos nuestro archivo <strong><em>functions.php</em></strong> e incluiremos esta funci√≥n:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="cp">&lt;?php</span>
	     <span class="c1">//  Main Sidebar</span>
	     <span class="k">if</span><span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">'register_sidebar'</span><span class="p">))</span>
	          <span class="nf">register_sidebar</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
	          <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Main Sidebar'</span><span class="p">,</span>
	           <span class="s1">'before_widget'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;hr&gt;'</span><span class="p">,</span>
	            <span class="s1">'after_widget'</span> <span class="o">=&gt;</span> <span class="s1">''</span><span class="p">,</span>
	          <span class="s1">'before_title'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;h3&gt;'</span><span class="p">,</span>
	          <span class="s1">'after_title'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;/h3&gt;'</span><span class="p">,</span>
	     <span class="p">));</span>
	<span class="cp">?&gt;</span>
</code></pre></div></div>

<p>Si activamos este tema y vamos a Apariencia -&gt; Widgets, veremos que nos aparece una nueva zona de widgets llamada Main Sidebar.</p>

<p>Una vez creada la zona lista para widgets, vamos a tener que llamarla dentro del archivo <strong><em>sidebar.php</em></strong>, otro archivo t√≠pico de casi todas las plantillas. Creamos este archivo y escribimos:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="nt">&lt;section</span> <span class="na">id=</span><span class="s">"sidebar"</span><span class="nt">&gt;</span>
	  <span class="cp">&lt;?php if ( !function_exists('dynamic_sidebar') || !dynamic_sidebar('Main Sidebar') ) : ?&gt;</span>
	  <span class="cp">&lt;?php endif; ?&gt;</span>
	<span class="nt">&lt;/section&gt;</span>
</code></pre></div></div>

<p>Hemos utilizado un id teniendo en cuenta que en este tema s√≥lo va a existir una barra lateral, pero si quieres crear m√°s, quiz√°s prefieras crear una clase. Con esto ya tenemos creada la barra lateral lista para widgets.</p>

<h4 id="paso-5-crear-el-footer"><strong>Paso 5: Crear el footer</strong></h4>

<p>Hasta aqu√≠ hemos creado la cabecera y la barra lateral. Ahora vamos a crear el footer para despu√©s integrarlo todo en index.php.</p>

<p>Recuerda que WordPress funciona por m√≥dulos, y que los m√≥dulos son como piezas de un puzle: hasta ahora hemos ido creando esas piezas para luego montarlas todas en index.php.</p>

<p>El footer se crea, oh sorpresa, en un archivo llamado <strong><em>footer.php</em></strong> que puede quedarnos as√≠:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="nt">&lt;footer&gt;</span>
	  <span class="nt">&lt;p&gt;</span><span class="ni">&amp;amp;</span>amp;amp;copy; <span class="cp">&lt;?php bloginfo('name'); ?&gt;</span>, <span class="cp">&lt;?=date('Y');?&gt;</span>. Mi primer tema.<span class="nt">&lt;/p&gt;</span>
	<span class="nt">&lt;/footer&gt;</span>
	<span class="nt">&lt;/div&gt;</span> <span class="c">&lt;!-- Fin de wrapper --&gt;</span>
	<span class="cp">&lt;?php wp_footer(); ?&gt;</span>
	<span class="nt">&lt;/body&gt;</span>
	<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>F√≠jate que la capa ‚Äúwrapper‚Äù empieza en el header y termina en el footer. Si queremos un header o un footer que se extienda por toda la pantalla, deberemos mover las posiciones de los div que abren y cierran la capa ‚Äúwrapper‚Äù.</p>

<p>Aqu√≠ aparece la funci√≥n wp_footer(), que es semejante a wp_header(). Estas funciones son lo que se llaman <strong>hooks de Wordpress</strong> y hacen funcionar los plugins que instalemos.</p>

<p>En el caso de wp_footer() va a ser, adem√°s, necesaria si queremos ver la barra de administraci√≥n de WordPress. No ser√°s el primero que se vuelve loco tratando de averiguar por qu√© no aparece la barra de administraci√≥n hasta que descubre que es porque no ha llamado a este hook de WordPress.</p>

<h4 id="paso-6-crear-la-p√°gina-principal"><strong>Paso 6: Crear la p√°gina principal</strong></h4>

<p>En este tema, la p√°gina principal se va a corresponder a los contenidos de <strong><em>index.php</em></strong>. Nuestro index tendr√° este aspecto:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="cp">&lt;?php get_header(); ?&gt;</span>
	  <span class="nt">&lt;section</span> <span class="na">id=</span><span class="s">"main"</span><span class="nt">&gt;</span>
	  <span class="nt">&lt;/section&gt;</span> <span class="c">&lt;!-- Fin de main --&gt;</span>
	    <span class="cp">&lt;?php  get_sidebar()?&gt;</span>
	  <span class="cp">&lt;?php get_footer(); ?&gt;</span>
</code></pre></div></div>

<p>Observa estas tres funciones: get_header(), get_sidebar() y get_footer():</p>

<ul>
  <li>get_header() inserta los contenidos del archivo header.php en ese punto.</li>
  <li>get_sidebar() hace lo mismo con la barra lateral.</li>
  <li>get_footer() hace‚Ä¶ bueno, ya te imaginas lo que hace, ¬øverdad?</li>
</ul>

<p>De modo que ya hemos montado nuestro puzle. Un puzle muy sencillito porque solo tiene tres piezas, vale. Pero ahora lo puedes complicar todo lo que quieras.</p>

<h4 id="paso-7-el-loop-de-wordpress"><strong>Paso 7. El loop de WordPress</strong></h4>

<p>En el <strong><em>loop</em></strong> reside toda la magia de Wordpress.</p>

<p>¬øQu√© es el loop? Es un bucle (claro) en el que se muestram las entradas almacenadas en la base de datos de Wordpress. Y nosotros podemos decidir c√≥mo se muestran esas entradas.</p>

<p>Este c√≥digo de ejemplo de loop debe a√±adirse a continuaci√≥n del anterior en <strong><em>index.php</em></strong>:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="cp">&lt;?php if (have_posts()) :  while (have_posts()) : the_post(); ?&gt;</span>
	    <span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">"&lt;?php the_permalink(); ?&gt;"</span><span class="nt">&gt;</span><span class="cp">&lt;?php the_title(); ?&gt;</span><span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>
	   <span class="nt">&lt;small&gt;</span>Publicado el <span class="cp">&lt;?php the_time('j/m/Y') ?&gt;</span> por <span class="cp">&lt;?php the_author_posts_link() ? &lt;/small&gt;
	    &lt;?php the_excerpt(); ?&gt;</span>
	  <span class="cp">&lt;?php endwhile; else: ?&gt;</span>
	    <span class="nt">&lt;p&gt;</span><span class="cp">&lt;?php _e('No hay entradas .'); ?&gt;</span><span class="nt">&lt;/p&gt;</span>
	  <span class="cp">&lt;?php endif; ?&gt;</span>
</code></pre></div></div>

<p>La primera l√≠nea es el aut√©ntico loop:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="cp">&lt;?php if(have_posts()) : ?&gt;&lt;?php while(have_posts()) : the_post(); ?&gt;</span>
</code></pre></div></div>

<p>Wordpress mirar√° si hay alguna entrada disponible (if(have_posts())). Si es as√≠, entramos en un bucle que se repite para todos los posts (while(have_posts())). Y, para cada post, se recupera su contenido de la base de datos (the_post()).</p>

<p>Una vez seleccionado el post, se muestra su informaci√≥n: la fecha de publicaci√≥n (the_time()), los autores (the_author_posts_link()), el extracto (the_excerpt())‚Ä¶ Si no hay posts, se muestra el mensaje de error ‚ÄúNo hay entradas‚Äù</p>

<h4 id="paso-8-a√±adir-thumbnails-al-loop"><strong>Paso 8. A√±adir thumbnails al loop</strong></h4>

<p>Si queremos a√±adir thumbnails (im√°genes destacadas) al loop como sucede en muchos portales WP, lo que haremos es lo siguiente: vamos al archivo functions.php y a√±adimos este c√≥digo:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="cp">&lt;?php
	//Habilitar thumbnails
	add_theme_support('post-thumbnails');
            set_post_thumbnail_size(150, 150, true);
	?&gt;</span>
</code></pre></div></div>

<p>Con este c√≥digo hemos habilitado los thumbnials de nuestras entradas y hemos establecido un tama√±o para las mismas de 150 por 150 p√≠xeles. Una vez hecho esto, modificaremos nuestro loop como sigue:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="cp">&lt;?php if (have_posts()) :  while (have_posts()) : the_post(); ?&gt;</span>
	    <span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">"&lt;?php the_permalink(); ?&gt;"</span><span class="nt">&gt;</span><span class="cp">&lt;?php the_title(); ?&gt;</span><span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>
	   <span class="nt">&lt;small&gt;</span>Publicado el <span class="cp">&lt;?php the_time('j/m/Y') ?&gt;</span> por <span class="cp">&lt;?php the_author_posts_link() ?&gt;</span>  <span class="nt">&lt;/small&gt;</span>
	   <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"thumbnail"</span><span class="nt">&gt;</span>
	      <span class="cp">&lt;?php
	          if ( has_post_thumbnail() ) {
	                the_post_thumbnail();
          }
	      ?&gt;</span>
	   <span class="nt">&lt;/div&gt;</span>
	      <span class="cp">&lt;?php the_excerpt(); ?&gt;</span>
	  <span class="cp">&lt;?php endwhile; else: ?&gt;</span>
	    <span class="nt">&lt;p&gt;</span><span class="cp">&lt;?php _e('No hay entradas .'); ?&gt;</span><span class="nt">&lt;/p&gt;</span>
	  <span class="cp">&lt;?php endif; ?&gt;</span>
</code></pre></div></div>

<p>Observa que hemos a√±adido un par de l√≠neas en las que se comprueba si el post tiene thumbnail y, en caso afirmativo, este se recupera.</p>

<p>La forma en la que queremos que se visualice todo esto debe establecerse mediante CSS, por supuesto.</p>

<p>Podr√≠amos seguir a√±adiendo cosas al loop. Por ejemplo: podr√≠amos a√±adir una paginaci√≥n de las entradas. Encontrar√°s en la red mucha informaci√≥n sobre el tema, aunque lo m√°s pr√°ctico es bajarse una plantilla sencillita ya hecha y curiosear en su c√≥digo fuente.</p>

<h4 id="paso-9-resultados-de-la-b√∫squeda"><strong>Paso 9. Resultados de la b√∫squeda</strong></h4>

<p>Los resultados de la b√∫squeda se especifican en el archivo <strong><em>search.php</em></strong>. He aqu√≠ un ejemplo:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="cp">&lt;?php get_header(); ?&gt;</span>
	    <span class="nt">&lt;section</span> <span class="na">id=</span><span class="s">"main"</span><span class="nt">&gt;</span>
	  <span class="nt">&lt;h2&gt;</span>Resultados de la b√∫squeda<span class="nt">&lt;/h2&gt;</span>
	         <span class="cp">&lt;?php if (have_posts()) :  while (have_posts()) : the_post(); ?&gt;</span>
	      <span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">"&lt;?php the_permalink(); ?&gt;"</span><span class="nt">&gt;</span><span class="cp">&lt;?php the_title(); ?&gt;</span><span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>
	     <span class="nt">&lt;small&gt;</span>Publicado el <span class="cp">&lt;?php the_time('j/m/Y') ?&gt;</span> por <span class="cp">&lt;?php the_author_posts_link() ?&gt;</span>  <span class="nt">&lt;/small&gt;</span>
	     <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"thumbnail"</span><span class="nt">&gt;</span>
	        <span class="cp">&lt;?php
	            if ( has_post_thumbnail() ) {
	                  the_post_thumbnail();
	            }
	        ?&gt;</span>
	     <span class="nt">&lt;/div&gt;</span>
	        <span class="cp">&lt;?php the_excerpt(); ?&gt;</span>
	 
	 <span class="cp">&lt;?php endwhile; ?&gt;</span>
	<span class="cp">&lt;?php if (function_exists("pagination")) {
	    pagination($additional_loop-&gt;max_num_pages);
	} ?&gt;</span>
	<span class="cp">&lt;?php  else: ?&gt;</span>
	<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"entry"</span><span class="nt">&gt;</span><span class="cp">&lt;?php _e('Lo sentimos, no hay resultados con este t√©rmino de b√∫squeda.'); ?&gt;</span><span class="nt">&lt;/div&gt;</span>
	<span class="cp">&lt;?php endif; ?&gt;</span>
	<span class="nt">&lt;/section&gt;</span> <span class="c">&lt;!-- Fin de main --&gt;</span>
	<span class="cp">&lt;?php  get_sidebar()?&gt;</span>
	<span class="cp">&lt;?php get_footer(); ?&gt;</span>
</code></pre></div></div>

<p>F√≠jate que se parece mucho a index.php.</p>

<p>Esta p√°gina es la que va a mostrar los resultados de una b√∫squeda en cuesti√≥n. As√≠, vamos a necesitar que aparezca un buscador en nuestra plantilla. Un buen sitio para colocarlo puede ser el sidebar. Iremos a nuestro archivo sidebar.php y justo antes de la funci√≥n que habilita la zona de widgets en el sidebar, incluimos este c√≥digo:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"get"</span> <span class="na">id=</span><span class="s">"searchform"</span> <span class="na">action=</span><span class="s">"&lt;?php bloginfo('url'); ?&gt;/"</span><span class="nt">&gt;</span>
	  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">placeholder=</span><span class="s">"Buscar‚Ä¶"</span> <span class="na">value=</span><span class="s">"&lt;?php the_search_query(); ?&gt;"</span> <span class="na">name=</span><span class="s">"s"</span> <span class="na">id=</span><span class="s">"s"</span> <span class="nt">/&gt;</span>
	  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">class=</span><span class="s">"icon-only"</span>  <span class="na">id=</span><span class="s">"searchsubmit"</span><span class="nt">&gt;&lt;/button&gt;</span>
	<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p>Con esto tenemos un campo de b√∫squeda en nuestra barra lateral. Para que se visualice como queremos, simplemente har√° falta crear el c√≥digo CSS necesario.</p>

<h4 id="paso-10-configurar-la-vista-de-las-entradas-posts"><strong>Paso 10. Configurar la vista de las entradas (posts)</strong></h4>

<p>La p√°gina del post es aquella donde vamos a ver una entrada individual, es decir, un post completo.</p>

<p>Vamos a poder definir c√≥mo se ve, incluir o no comentarios, etc.</p>

<p>El archivo donde se define esto se denomina <strong><em>single.php</em></strong>, y puede ser m√°s o menos as√≠:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="cp">&lt;?php get_header(); ?&gt;</span>
	    <span class="nt">&lt;section</span> <span class="na">id=</span><span class="s">"main"</span><span class="nt">&gt;</span>
	        <span class="nt">&lt;article</span> <span class="na">id=</span><span class="s">"single"</span><span class="nt">&gt;</span>
	          <span class="cp">&lt;?php if(have_posts()) : ?&gt;&lt;?php while(have_posts()) : the_post(); ?&gt;</span>
	            <span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">"&lt;?php the_permalink() ?&gt;"</span> <span class="na">rel=</span><span class="s">"bookmark"</span> <span class="na">title=</span><span class="s">"Enlace permanente a &lt;?php the_title_attribute(); ?&gt;"</span><span class="nt">&gt;</span><span class="cp">&lt;?php the_title(); ?&gt;</span>. <span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>
	              <span class="nt">&lt;small&gt;</span> Publicado por <span class="cp">&lt;?php the_author_posts_link() ?&gt;</span>  el <span class="cp">&lt;?php the_time('j/m/Y') ?&gt;</span>. Categor√≠a: <span class="cp">&lt;?php the_category(', '); ?&gt;</span> <span class="nt">&lt;/small&gt;&lt;br&gt;</span>
	          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"post"</span><span class="nt">&gt;</span>
	 
	             <span class="cp">&lt;?php the_content(); ?&gt;</span>
	        <span class="nt">&lt;/div&gt;</span>
	<span class="cp">&lt;?php endwhile; ?&gt;</span>
	<span class="cp">&lt;?php endif; ?&gt;</span>
	  <span class="nt">&lt;/article&gt;</span> <span class="c">&lt;!-- Fin de single --&gt;</span>
	  <span class="nt">&lt;/section&gt;</span> <span class="c">&lt;!-- Fin de main --&gt;</span>
	  <span class="cp">&lt;?php  get_sidebar()?&gt;</span>
	<span class="cp">&lt;?php get_footer(); ?&gt;</span>
</code></pre></div></div>

<p>Si has llegado hasta aqu√≠, te resultar√° f√°cil comprender el archivo. Si en el loop utilizamos the_excerpt() para mostrar el extracto de la entrada, aqu√≠ utilizamos la funci√≥n the_content() para recuperar el contenido completo de la entrada.</p>

<p>Por supuesto, esto se puede complicar hasta el infinito. A modo de ejemplo, mostraremos c√≥mo podr√≠amos mostrar las entradas relacionadas. Bastar√≠a con a√±adir este c√≥digo justo despu√©s de mostrar el contenidos de la entrada:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	    <span class="cp">&lt;?php
	    $tags = wp_get_post_tags($post-&gt;ID);
	    if ($tags) {
	      $tag_ids = array();
	      foreach($tags as $individual_tag) $tag_ids[] = $individual_tag-&gt;term_id;
	      $args=array(
	      'tag__in' =&gt; $tag_ids,
	      'post__not_in' =&gt; array($post-&gt;ID),
	      'showposts'=&gt;5, // Number of related posts that will be shown.
	      'caller_get_posts'=&gt;1
	      );
	    $my_query = new wp_query($args);
	      if( $my_query-&gt;have_posts() ) {
	        echo '&lt;h3&gt;Art√≠culos relacionados&lt;/h3&gt;&lt;ul&gt;';
	        while ($my_query-&gt;have_posts()) {
	          $my_query-&gt;the_post();
	          ?&gt;</span>
	          <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"&lt;?php the_permalink() ?&gt;"</span> <span class="na">rel=</span><span class="s">"bookmark"</span> <span class="na">title=</span><span class="s">"Permanent Link to &lt;?php the_title_attribute(); ?&gt;"</span><span class="nt">&gt;</span><span class="cp">&lt;?php the_title(); ?&gt;</span><span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
	        <span class="cp">&lt;?php
	        }
	        echo '&lt;/ul&gt;';
	      }
	         wp_reset_query();
	    }
	?&gt;</span>
</code></pre></div></div>

<h4 id="paso-11-habilitar-y-mostrar-los-comentarios"><strong>Paso 11: Habilitar y mostrar los comentarios</strong></h4>

<p>Para permitir los comentarios en una entrada, a√±adiremos este c√≥digo a nuestro archivo <strong><em>functions.php</em></strong>:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>       <span class="c1">// Permitir comentarios encadenados</span>
	<span class="k">function</span> <span class="n">enable_threaded_comments</span><span class="p">(){</span>
	    <span class="k">if</span> <span class="p">(</span><span class="nf">is_singular</span><span class="p">()</span> <span class="k">AND</span> <span class="nf">comments_open</span><span class="p">()</span> <span class="k">AND</span> <span class="p">(</span><span class="nf">get_option</span><span class="p">(</span><span class="s1">'thread_comments'</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
	       <span class="nf">wp_enqueue_script</span><span class="p">(</span><span class="s1">'comment-reply'</span><span class="p">);</span>
	    <span class="p">}</span>
	<span class="p">}</span>
	<span class="nf">add_action</span><span class="p">(</span><span class="s1">'get_header'</span><span class="p">,</span> <span class="s1">'enable_threaded_comments'</span><span class="p">);</span>
</code></pre></div></div>

<p>Y en <strong><em>single.php</em></strong>, justo antes de la l√≠nea del endwhile, a√±adiremos:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"comentarios"</span><span class="nt">&gt;</span>
	  <span class="cp">&lt;?php comments_template(); ?&gt;</span>
	<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<p>Nuevamente, ser√° el CSS el que determine c√≥mo se ver√°n los comentarios. Aqu√≠ tienes un ejemplo de CSS para empezar a trabajar en √©l:</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="nc">.commentlist</span> <span class="nt">li</span> <span class="p">{</span>
	  <span class="nl">list-style</span><span class="p">:</span> <span class="nb">none</span> <span class="cp">!important</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="nc">.comment-body</span> <span class="p">{</span>
	  <span class="nl">padding</span><span class="p">:</span> <span class="m">15px</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="nc">.comment-author</span> <span class="p">{</span>
	  <span class="nl">margin-top</span><span class="p">:</span> <span class="m">5px</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="nc">.reply</span><span class="o">,</span>  <span class="nc">.commentmetadata</span> <span class="p">{</span>
	  <span class="nl">font-size</span><span class="p">:</span> <span class="m">0.9em</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="nc">.depth-1</span><span class="o">,</span> <span class="nc">.depth-2</span><span class="o">,</span> <span class="nc">.depth-3</span><span class="o">,</span> <span class="nc">.depth-4</span> <span class="p">{</span>
	  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#eaeaea</span><span class="p">;</span>
	  <span class="nl">border-radius</span><span class="p">:</span> <span class="m">4px</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="nc">.depth-1</span><span class="o">,</span> <span class="nc">.depth-3</span> <span class="p">{</span>
	  <span class="nl">background-color</span><span class="p">:</span> <span class="m">#fafafa</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="nc">.depth-2</span><span class="o">,</span> <span class="nc">.depth-4</span> <span class="p">{</span>
	   <span class="nl">background-color</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="nc">.comment-author-eSandra</span> <span class="p">{</span>
	  <span class="nl">border</span><span class="p">:</span> <span class="m">3px</span> <span class="nb">solid</span> <span class="m">#eaeaea</span><span class="p">;</span>
	  <span class="nl">border-left</span><span class="p">:</span><span class="m">3px</span> <span class="nb">solid</span> <span class="m">#fbc356</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="nc">.depth-1</span> <span class="p">{</span>
	   <span class="nl">margin</span><span class="p">:</span> <span class="m">20px</span> <span class="m">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="c">/* Respuesta a comentarios*/</span>
	<span class="nc">.depth-2</span> <span class="p">{</span>
	  <span class="nl">margin</span><span class="p">:</span><span class="m">2%</span> <span class="m">5%</span> <span class="cp">!important</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="nc">.depth-3</span> <span class="p">{</span>
	   <span class="nl">margin</span><span class="p">:</span> <span class="m">2%</span> <span class="m">7%</span> <span class="cp">!important</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="nc">.depth-4</span> <span class="p">{</span>
	  <span class="nl">margin</span><span class="p">:</span><span class="m">2%</span> <span class="m">5%</span> <span class="m">4%</span> <span class="m">10%</span> <span class="cp">!important</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="nf">#comment</span><span class="o">,</span> <span class="nf">#author</span><span class="o">,</span> <span class="nf">#email</span> <span class="p">{</span>
	  <span class="nl">border-radius</span><span class="p">:</span> <span class="m">4px</span><span class="p">;</span>
	  <span class="nl">border</span><span class="p">:</span><span class="m">2px</span> <span class="nb">solid</span> <span class="m">#ccc</span><span class="p">;</span>
	<span class="p">}</span>
</code></pre></div></div>

<h4 id="paso-12-crear-la-p√°gina-de-categor√≠as-y-etiquetas"><strong>Paso 12: Crear la p√°gina de categor√≠as y etiquetas</strong></h4>

<p>Los archivos <strong>category.php</strong> y <strong>tags.php</strong> son pr√°cticamente iguales. Simplemente a√±adiremos antes del loop:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="cp">&lt;?php $post = $posts[0];  ?&gt;</span>
	  <span class="cp">&lt;?php  if (is_category()) { ?&gt;</span>
	  <span class="cp">&lt;?php } elseif( is_tag() ) { ?&gt;</span>
	    <span class="nt">&lt;h2&gt;</span>Etiqueta <span class="ni">&amp;amp;</span>amp;amp;#8216;<span class="cp">&lt;?php single_tag_title(); ?&gt;</span><span class="ni">&amp;amp;</span>amp;amp;#8217;<span class="nt">&lt;/h2&gt;</span>
	  <span class="cp">&lt;?php } elseif (is_day()) { ?&gt;</span>
	    <span class="nt">&lt;h2&gt;</span>Archivo para <span class="cp">&lt;?php the_time('F jS Y'); ?&gt;</span>:<span class="nt">&lt;/h2&gt;</span>
	  <span class="cp">&lt;?php  } elseif (is_month()) { ?&gt;</span><span class="nt">&lt;h2&gt;</span>Archivo para <span class="cp">&lt;?php the_time('F, Y'); ?&gt;</span>:<span class="nt">&lt;/h2&gt;</span>
	  <span class="cp">&lt;?php } elseif (is_year()) { ?&gt;</span>
	    <span class="nt">&lt;h2&gt;</span>Archivo para <span class="cp">&lt;?php the_time('Y'); ?&gt;</span>:<span class="nt">&lt;/h2&gt;</span>
	  <span class="cp">&lt;?php /} elseif (is_author()) { ?&gt;</span>
	    <span class="nt">&lt;h2&gt;</span>Archivo del autor <span class="nt">&lt;/h2&gt;</span>
	  <span class="cp">&lt;?php } elseif (isset($_GET['paged']) &amp;amp;amp;amp;&amp;amp;amp;amp; !empty($_GET['paged'])) { ?&gt;</span>
	    <span class="nt">&lt;h2&gt;</span>Archivos del blog<span class="nt">&lt;/h2&gt;</span>
	<span class="cp">&lt;?php } ?&gt;</span>
</code></pre></div></div>

<h4 id="y-ahora-qu√©"><strong>¬øY ahora qu√©?</strong></h4>

<p>Ya tienes una plantilla sencilla y funcional creada desde cero.</p>

<p>La creaci√≥n de plantillas no termina aqu√≠, claro. Solo hemos dado los primeros pasos y sentado unas bases lo m√°s s√≥lidas posible. La API de WordPress es muy amplia, a menudo confusa y casi siempre redundante. Especializarse en el desarrollo para WordPress es una tarea de largo recorrido que no puede aprenderse en unas cuantas horas.</p>

<p>Pero, si has llegado hasta aqu√≠, ya has hecho, probablemente, lo m√°s dif√≠cil.</p>

<p>La mayor√≠a de las plantillas tienen m√°s archivos que la nuestra, como, por ejemplo:</p>

<ul>
  <li><strong>page.php</strong>, para mostrar p√°ginas est√°ticas.</li>
  <li><strong>author.php</strong>, para mostrar la p√°gina de ‚Äúacerca de‚Äù.</li>
  <li><strong>404.php</strong>, para crear nuestra propia p√°gina de error ‚Äúnot found‚Äù</li>
</ul>

<p>Por √∫ltimo, aqu√≠ tienes un diagrama de las relaciones que existen entre los archivos t√≠picos de una plantilla Wordpress. Recuerda que el √∫nico obligatorio (adem√°s de styles.css) es index.php, y que una plantilla compleja puede tener otros archivos adicionales a los que aqu√≠ se muestran.</p>

<p>XXX esquema</p>

<h3 id="123-plugins-de-wordpress">1.2.3. Plugins de Wordpress</h3>

<p>(El contenido de esta secci√≥n est√° adaptado de: www.cristalab.com/tutoriales/como-crear-un-plugin-para-wordpress-c54308l/)</p>

<h4 id="los-plugins-de-wordpress"><strong>Los plugins de WordPress</strong></h4>

<p>Los plugins, como en cualquier otro sistema, a√±aden funcionalidades a Wordpress. La arquitectura flexible de Wordpress permite realizar esa ampliaci√≥n en casi cualquier sentido, dotando a Wordpress de esa capacidad polim√≥rfica que lo hace tan √∫til en muchas circunstancias.</p>

<p>A partir de aqu√≠ vamos a crear un sencillo plugin para Wordpress que pueda servir de base para desarrollos posteriores m√°s realistas.</p>

<p>El plugin se llamar√° ‚ÄúSaludo‚Äù y contendr√° algunas funciones para saludar que nos servir√°n para ilustrar el funcionamiento del sistema de plugins de WordPress.</p>

<h4 id="crear-un-plugin-nuevo"><strong>Crear un plugin nuevo</strong></h4>

<p>Para crear el plugin ‚ÄúSaludo‚Äù basta con crear un archivo llamado <strong><em>saludo.php</em></strong> en una carpeta llamada tambi√©n ‚Äúsaludo‚Äù y ubicada a su vez en carpeta_raiz/wp-content/plugins/</p>

<p>Dentro del archivo saludo.php, escribiremos el comentario de cabecera para que WordPress lo reconozca como un plugin v√°lido (igual que sucede con las plantillas). Es importante respetar la sintaxis.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
   <span class="cm">/*
      Plugin Name: nombre del plugin
      Plugin URI: url oficial de tu maravilloso plugin
      Description: que carajos hace tu plugin
      Version: numero de intentos para que esta cosa resulte
      Author: Nombre del mono programador
      Author URI: url del mono programador
   */</span>
   
   <span class="cm">/*
      esto aparecer√° directamente en el panel de 
      administraci√≥n de plugins
   */</span> 
<span class="cp">?&gt;</span>
</code></pre></div></div>

<h4 id="a√±adir-funciones-al-plugin"><strong>A√±adir funciones al plugin</strong></h4>

<p>Vamos a crear nuestra primera funci√≥n con un c√≥digo algo m√°s complejo. Todo lo que sigue se debe escribir en el mismo archivo <strong><em>saludo.php</em></strong>.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
   <span class="c1">// Aqu√≠ van los comentarios de la cabecera que vimos antes</span>
   <span class="k">function</span> <span class="n">saludo</span><span class="p">(){</span>
      <span class="k">echo</span> <span class="s1">'hola mundo'</span><span class="p">;</span>   
   <span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<h4 id="instalar-y-desinstalar-el-plugin"><strong>Instalar y desinstalar el plugin</strong></h4>

<p>Para poder instalar y desinstalar el plugin desde el panel de administracion de Wordpress, es necesario crear dos funciones en <strong><em>saludo.php</em></strong>: una para instalar y otra para desinstalar. Estas funciones, por ahora, las dejaremos vac√≠as.</p>

<p>Adem√°s, al final del archivo <strong><em>saludo.php</em></strong> hay que usar la funcion del API de Wordpress add_action() para indicar las funciones que activar y desactivan el plugin.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
   <span class="mf">...</span>
   <span class="k">function</span> <span class="n">saludo_instala</span><span class="p">(){</span>
      <span class="c1">//   Por ahora la dejamos vac√≠a</span>
   <span class="p">}</span>
   <span class="k">function</span> <span class="n">saludo_desinstala</span><span class="p">(){</span>
      <span class="c1">//   Por ahora la dejamos vac√≠a</span>
   <span class="p">}</span>   
<span class="c1">// Ojo con la sintaxis de la funcion add_action!</span>
<span class="nf">add_action</span><span class="p">(</span><span class="s1">'activate_saludo/saludo.php'</span><span class="p">,</span><span class="s1">'saludo_instala'</span><span class="p">);</span>
<span class="nf">add_action</span><span class="p">(</span><span class="s1">'deactivate_saludo/saludo.php'</span><span class="p">,</span> <span class="s1">'saludo_desinstala'</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<h4 id="c√≥mo-usar-las-funciones-del-plugin"><strong>C√≥mo usar las funciones del plugin</strong></h4>

<p>Ahora ya puedes usar tu maravilloso plugin. S√≥lo debes colocar en la secci√≥n de tu plantilla que estimes conveniente la siguiente l√≠nea:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span> <span class="nf">saludo</span><span class="p">();</span> <span class="cp">?&gt;</span>
</code></pre></div></div>

<h4 id="configurar-el-plugin-desde-el-panel-de-administraci√≥n"><strong>Configurar el plugin desde el panel de administraci√≥n</strong></h4>

<p>Nos falta crear un item dentro del panel de administraci√≥n que nos permita modificar las opciones de este plugin. El √≠tem lo daremos de alta dentro del men√∫ ‚Äúopciones‚Äù, y para esto programaremos tres funciones m√°s en nuestro archivo <strong><em>saludo.php</em></strong>:</p>

<ul>
  <li>saludo_panel(): aqu√≠ incluiremos el html que ser√° expresado en nuestro panel. Para no mezclar html dentro del c√≥digo, usaremos la funci√≥n include() a modo de template.</li>
  <li>saludo_add_menu(): aqu√≠ usaremos a su vez la funci√≥n de WP add_options_page.</li>
  <li>saludo_add_action(): para desencadenar todo esto usaremos esta funci√≥n que es tambi√©n parte del API de WP.</li>
</ul>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
   <span class="mf">...</span>
   
   <span class="k">function</span> <span class="n">saludo_panel</span><span class="p">(){</span>      
      <span class="k">include</span><span class="p">(</span><span class="s1">'template/panel.html'</span><span class="p">);</span>
   <span class="p">}</span>
   <span class="k">function</span> <span class="n">saludo_add_menu</span><span class="p">(){</span>   
      <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">'add_options_page'</span><span class="p">))</span> <span class="p">{</span>
         <span class="c1">//add_menu_page</span>
         <span class="nf">add_options_page</span><span class="p">(</span><span class="s1">'saludo'</span><span class="p">,</span> <span class="s1">'saludo'</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="nb">basename</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">),</span> <span class="s1">'saludo_panel'</span><span class="p">);</span>
      <span class="p">}</span>
   <span class="p">}</span>
   <span class="k">if</span> <span class="p">(</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">'add_action'</span><span class="p">))</span> <span class="p">{</span>
      <span class="nf">add_action</span><span class="p">(</span><span class="s1">'admin_menu'</span><span class="p">,</span> <span class="s1">'saludo_add_menu'</span><span class="p">);</span> 
   <span class="p">}</span> 
      
   <span class="mf">...</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<p>Adem√°s, necesitaremos un formulario html para poder visualizar la pantalla de configuraci√≥n en el panel de administraci√≥n de Wordpress. Crearemos algo muy sencillo. Por supuesto, se puede mejorar con un poco de HTML y CSS. Lo escribiremos en el archivo <strong><em>template/panel.html</em></strong>:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"post"</span> <span class="na">action=</span><span class="s">""</span> <span class="na">id=</span><span class="s">"saludo"</span><span class="nt">&gt;</span>
<span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"saludo_inserta"</span> <span class="na">accesskey=</span><span class="s">"s"</span><span class="nt">&gt;</span>Inserte su saludo<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">'text'</span> <span class="na">id=</span><span class="s">'saludo_inserta'</span>  <span class="na">name=</span><span class="s">'saludo_inserta'</span> <span class="na">value=</span><span class="s">''</span> <span class="nt">/&gt;&lt;/label&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">'submit'</span> <span class="na">name=</span><span class="s">''</span> <span class="na">value=</span><span class="s">'enviar'</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p>Por √∫ltimo, modificaremos la funci√≥n saludo_panel() para poder visualizar nuestros avances:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
   <span class="mf">...</span>   
   <span class="k">function</span> <span class="n">saludo_panel</span><span class="p">(){</span>      
      <span class="k">include</span><span class="p">(</span><span class="s1">'template/panel.html'</span><span class="p">);</span>
   <span class="p">}</span>
   <span class="k">echo</span> <span class="s2">"&lt;h1&gt;</span><span class="si">{</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'saludo'</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/h1&gt;"</span><span class="p">;</span>
   <span class="mf">...</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<p>Podemos probar que todo funciona escribiendo algo en el formulario (pulsando ‚ÄúEnviar‚Äù).</p>

<h4 id="acceder-a-la-bd-desde-nuestro-plugin"><strong>Acceder a la BD desde nuestro plugin</strong></h4>

<p>Vamos a ver c√≥mo se puede acceder a la BD de WordPress desde un plugin.</p>

<p>Para ello, antes debemos desinstalar el plugin desde el panel de control. Solo as√≠ podremos modificar la funci√≥n de instalaci√≥n y ejecutarla m√°s adelante de nuevo.</p>

<p>Las funciones de Wordpress que manejan la DB se llaman con una variable global denominada <strong><em>$wpdb</em></strong>:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="mf">...</span>

<span class="k">function</span> <span class="n">saludo_instala</span><span class="p">(){</span>
   <span class="k">global</span> <span class="nv">$wpdb</span><span class="p">;</span> <span class="c1">// &lt;-- sin esto no funcionara nada con la DB no cambies nada</span>
   <span class="nv">$table_name</span><span class="o">=</span> <span class="nv">$wpdb</span><span class="o">-&gt;</span><span class="n">prefix</span> <span class="mf">.</span> <span class="s2">"saludos"</span><span class="p">;</span>
   <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">" CREATE TABLE </span><span class="nv">$table_name</span><span class="s2">(
      id mediumint( 9 ) NOT NULL AUTO_INCREMENT ,
      saludo tinytext NOT NULL ,
      PRIMARY KEY ( `id` )   
   ) ;"</span><span class="p">;</span>
   <span class="nv">$wpdb</span><span class="o">-&gt;</span><span class="nf">query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
   <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">"INSERT INTO </span><span class="nv">$table_name</span><span class="s2"> (saludo) VALUES ('Hola Mundo');"</span><span class="p">;</span>
   <span class="nv">$wpdb</span><span class="o">-&gt;</span><span class="nf">query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
<span class="p">}</span>   

<span class="k">function</span> <span class="n">saludo_desinstala</span><span class="p">(){</span>
   <span class="k">global</span> <span class="nv">$wpdb</span><span class="p">;</span> 
   <span class="nv">$tabla_nombre</span> <span class="o">=</span> <span class="nv">$wpdb</span><span class="o">-&gt;</span><span class="n">prefix</span> <span class="mf">.</span> <span class="s2">"saludos"</span><span class="p">;</span>
   <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">"DROP TABLE </span><span class="nv">$tabla_nombre</span><span class="s2">"</span><span class="p">;</span>
   <span class="nv">$wpdb</span><span class="o">-&gt;</span><span class="nf">query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
<span class="p">}</span>   
   
<span class="mf">...</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<p>Por supuesto, hay que agregar los datos a la DB desde nuestro panel en opciones/saludo, para lo cual modificaremos la funci√≥n saludo_panel():</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="mf">...</span>

<span class="k">function</span> <span class="n">saludo_panel</span><span class="p">(){</span>
   <span class="k">include</span><span class="p">(</span><span class="s1">'template/panel.html'</span><span class="p">);</span>         
   <span class="k">global</span> <span class="nv">$wpdb</span><span class="p">;</span> 
   <span class="nv">$table_name</span> <span class="o">=</span> <span class="nv">$wpdb</span><span class="o">-&gt;</span><span class="n">prefix</span> <span class="mf">.</span> <span class="s2">"saludos"</span><span class="p">;</span>
   <span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'saludo_inserta'</span><span class="p">])){</span>   
         <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">"INSERT INTO </span><span class="nv">$table_name</span><span class="s2"> (saludo) VALUES ('</span><span class="si">{</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'saludo_inserta'</span><span class="p">]</span><span class="si">}</span><span class="s2">');"</span><span class="p">;</span>
         <span class="nv">$wpdb</span><span class="o">-&gt;</span><span class="nf">query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
   <span class="p">}</span>
<span class="p">}</span>
      
<span class="mf">...</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<p>¬°Ahora que ya podemos insertar saludos en nuestra BD!</p>

<p>s√≥lo nos queda poder mostrarlos en nuestra funci√≥n saludo(). Para esto extraeremos un saludo de manera aleatoria a nuestra BD:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?php
...

function saludo(){
   global $wpdb; 
   $table_name = $wpdb-&gt;prefix . "saludos";
   $saludo= $wpdb-&gt;get_var("SELECT saludo FROM $table_name ORDER BY RAND() LIMIT 0, 1; " );
   include('template/saludo.html');      
}
   
...
?&gt;
</code></pre></div></div>

<p>Ahora modifiquemos nuestro <strong><em>saludo.html</em></strong> para que imprima la variable $saludo:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;h1&gt;</span><span class="cp">&lt;?php echo $saludo;?&gt;</span><span class="nt">&lt;/h1&gt;</span>
</code></pre></div></div>

<p>Por √∫ltimo, vamos modificar el html de nuestro panel para que se adapte al html del administrador de WP y no quede tan feo:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"wrap"</span><span class="nt">&gt;</span> 
   <span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"post"</span> <span class="na">action=</span><span class="s">""</span><span class="nt">&gt;</span>
      <span class="nt">&lt;fieldset&gt;</span>
         <span class="nt">&lt;legend&gt;</span>Ingresar Nuevo Saludo<span class="nt">&lt;/legend&gt;</span>
         <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"saludo"</span> <span class="na">accesskey=</span><span class="s">"s"</span><span class="nt">&gt;</span>Inserte su saludo<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">'text'</span> <span class="na">id=</span><span class="s">'saludo_inserta'</span>  <span class="na">name=</span><span class="s">'saludo_inserta'</span>  <span class="nt">/&gt;&lt;/label&gt;</span>
         <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">'submit'</span> <span class="na">name=</span><span class="s">''</span> <span class="na">value=</span><span class="s">'enviar'</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/fieldset&gt;</span>
   <span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<p>Con todo esto ya tenemos listo nuestro plugin.</p>

<p>Por supuesto, siguiendo la misma l√≥gica podr√≠amos eliminar o modificar registros o hacer cualquier otra operaci√≥n que necesit√°semos con la base de datos.</p>

:ET